

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Graphs &#8212; FoCSipedia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Formal Languages" href="../lang/index.html" />
    <link rel="prev" title="Binary Search Trees and Heaps" href="bst.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/SmartFoxLogo.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">FoCSipedia</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution.html">
   Attribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../topics.html">
   Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview of Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../logic/index.html">
   Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sets/index.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fp/index.html">
   Functional Programming
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="index.html">
   Data Structures
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="lists.html">
     Sorting Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees.html">
     Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bst.html">
     Binary Search Trees and Heaps
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Graphs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lang/index.html">
   Formal Languages
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ds/graphs.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-terminology">
   Graph Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-representations">
   Graph Representations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-traversals">
   Graph Traversals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#depth-first-traversal">
     Depth-First Traversal
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reasonml-implementation-of-depth-first-traversal">
     ReasonML Implementation of Depth-First Traversal
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#breath-first-traversal">
     Breath-First Traversal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dijkstra-s-algorithm">
       Dijkstra’s Algorithm
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prim-s-algorithm">
       Prim’s Algorithm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="graphs">
<h1>Graphs<a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="graph-terminology">
<h2>Graph Terminology<a class="headerlink" href="#graph-terminology" title="Permalink to this headline">¶</a></h2>
<p>A <strong>graph</strong> is a general data structure for showing connections among a set of objects.
The objects are called <strong>nodes</strong> or <strong>vertices</strong>, and we will usually label them with a unique number or string.
The connections are called <strong>edges</strong>; an edge connects two nodes.
Depending on the application, there may be additional conditions or properties of edges:</p>
<ul class="simple">
<li><p>In an <strong>undirected</strong> graph, an edge linking <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(y\)</span> is also a link from <span class="math notranslate nohighlight">\(y\)</span> to <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>In a <strong>directed</strong> graph, we distinguish an edge from <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(y\)</span> (we refer to <span class="math notranslate nohighlight">\(x\)</span> as the <strong>source</strong> and <span class="math notranslate nohighlight">\(y\)</span> as the <strong>target</strong>) from an edge going the other way, from <span class="math notranslate nohighlight">\(y\)</span> to <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>In a <strong>simple</strong> graph, there must be at most one edge connecting any pair of nodes, and there are no <strong>loops</strong> (edges from a node to itself).</p></li>
<li><p>To emphasize that multiple edges are allowed between nodes we may refer to a <strong>multigraph</strong>; to emphasize that loops are allowed we may refer to a <strong>loop graph</strong>. A multigraph with loops is sometimes called a <strong>pseudograph</strong>, although we will generally just refer to all of these variants as graphs and only make distinctions where needed.</p></li>
<li><p>An edge may be <strong>labeled</strong> with a number or string; we do not generally require edge labels to be unique.</p></li>
<li><p>If there is an edge from <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(y\)</span>, then we say that <span class="math notranslate nohighlight">\(y\)</span> is <strong>adjacent</strong> to <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</div>
<div class="section" id="graph-representations">
<h2>Graph Representations<a class="headerlink" href="#graph-representations" title="Permalink to this headline">¶</a></h2>
<p>One representation of an unlabeled graph is simply as a set of ordered pairs of nodes.
This corresponds to the usual notion of a <strong>relation</strong> as a set of pairs (sometimes called, perhaps confusingly, the “graph” of the relation).</p>
<p>Another representation is as a function (often given in the form of a table) from nodes to a set of neighbors (<em>i.e.</em>, the adjacent nodes).
The set of neighbors of each node is often presented as a list, which leads to the term <strong>adjacency list</strong> for this presentation.</p>
<p>A third representation is as an <strong>adjacency matrix</strong>.
If the nodes are numbered 1 through <span class="math notranslate nohighlight">\(N\)</span>, then the adjacency matrix is the two-dimensional array where the entry in row <span class="math notranslate nohighlight">\(i\)</span>, column <span class="math notranslate nohighlight">\(j\)</span> will be 1 (or ‘true’) if there is an edge from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> and 0 (‘false’) if not.
This representation is often extended to labeled graphs where the labels are <strong>weights</strong>: the entry for <span class="math notranslate nohighlight">\((i,j)\)</span> gives the weight (or distance, or cost, …) of the edge between <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>.
Depending on the application, it may be preferable to use an infinite weight to represent absent edges, rather than 0 (since a weight of 0 might be interpreted as saying there is no cost to go from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span>).</p>
<p>Here is some ReasonML code defining types for these representations, plus some conversion functions. In each case, the type is parameterized by a node type <code class="docutils literal notranslate"><span class="pre">'n</span></code>, and the representation type is a pair where the first element is the list of nodes (because there is no generic way to get this list for an arbitrary type <code class="docutils literal notranslate"><span class="pre">'n</span></code>, and if <code class="docutils literal notranslate"><span class="pre">'n</span></code> is <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span></code> we only want to use a subset of the possible values anyway). The code uses a number of standard functions on lists such as <code class="docutils literal notranslate"><span class="pre">List.map</span></code> and <code class="docutils literal notranslate"><span class="pre">List.filter</span></code>; for details, see the <a class="reference external" href="https://reasonml.github.io/api/List.html">library documentation</a>.</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">graphPairs</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="ow">(</span><span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">),</span> <span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">)));</span>
<span class="k">type</span> <span class="n">graphAdjList</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="ow">(</span><span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">),</span> <span class="k">&#39;</span><span class="n">n</span> <span class="ow">=&gt;</span> <span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">));</span>
<span class="k">type</span> <span class="n">graphAdjMatrix</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="ow">(</span><span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">),</span> <span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="kt">bool</span><span class="ow">);</span>

<span class="k">let</span> <span class="n">adjlist_of_pairs</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="n">node</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(</span><span class="n">p</span> <span class="ow">=&gt;</span> <span class="n">snd</span><span class="ow">(</span><span class="n">p</span><span class="ow">),</span> <span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="ow">(</span><span class="n">p</span> <span class="ow">=&gt;</span> <span class="n">fst</span><span class="ow">(</span><span class="n">p</span><span class="ow">)</span> <span class="ow">==</span> <span class="n">node</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">))</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">adjmatrix_of_pairs</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="n">p</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">exists</span><span class="ow">(</span><span class="n">q</span> <span class="ow">=&gt;</span> <span class="n">p</span> <span class="ow">==</span> <span class="n">q</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">)</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">pairs_of_adjlist</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">alist</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="nn">List</span><span class="p">.</span><span class="n">flatten</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(</span><span class="n">node</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(</span><span class="n">adj</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">adj</span><span class="ow">),</span> <span class="n">alist</span><span class="ow">(</span><span class="n">node</span><span class="ow">)),</span> <span class="n">nodes</span><span class="ow">))</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">adjmatrix_of_adjlist</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">alist</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="n">p</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">exists</span><span class="ow">(</span><span class="n">node</span> <span class="ow">=&gt;</span> <span class="n">snd</span><span class="ow">(</span><span class="n">p</span><span class="ow">)</span> <span class="ow">==</span> <span class="n">node</span><span class="ow">,</span> <span class="n">alist</span><span class="ow">(</span><span class="n">fst</span><span class="ow">(</span><span class="n">p</span><span class="ow">)))</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">pairs_of_adjmatrix</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">amat</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="nn">List</span><span class="p">.</span><span class="n">flatten</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(</span><span class="n">i</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">flatten</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(</span><span class="n">j</span> <span class="ow">=&gt;</span> <span class="k">if</span> <span class="ow">(</span><span class="n">amat</span><span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">)))</span> <span class="ow">[(</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">)]</span> <span class="k">else</span> <span class="bp">[]</span><span class="ow">,</span> <span class="n">nodes</span><span class="ow">)),</span> <span class="n">nodes</span><span class="ow">))</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">adjlist_of_adjmatrix</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">amat</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span>
    <span class="n">i</span> <span class="ow">=&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="ow">(</span><span class="n">j</span> <span class="ow">=&gt;</span> <span class="n">amat</span><span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">)),</span> <span class="n">nodes</span><span class="ow">)</span>
  <span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">print_list</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">items</span><span class="ow">,</span> <span class="n">string_of_item</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">switch</span> <span class="ow">(</span><span class="n">items</span><span class="ow">)</span> <span class="ow">{</span>
  <span class="ow">|</span> <span class="bp">[]</span> <span class="ow">=&gt;</span> <span class="n">print_newline</span><span class="bp">()</span>
  <span class="ow">|</span> <span class="ow">[</span><span class="n">last</span><span class="ow">]</span> <span class="ow">=&gt;</span> <span class="n">print_string</span><span class="ow">(</span><span class="n">string_of_item</span><span class="ow">(</span><span class="n">last</span><span class="ow">)</span> <span class="ow">++</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">)</span>
  <span class="ow">|</span> <span class="ow">[</span><span class="n">head</span><span class="ow">,</span> <span class="ow">...</span><span class="n">tail</span><span class="ow">]</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="n">print_string</span><span class="ow">(</span><span class="n">string_of_item</span><span class="ow">(</span><span class="n">head</span><span class="ow">)</span> <span class="ow">++</span> <span class="s2">&quot;, &quot;</span><span class="ow">);</span>
      <span class="n">print_list</span><span class="ow">(</span><span class="n">tail</span><span class="ow">,</span> <span class="n">string_of_item</span><span class="ow">)</span>
    <span class="ow">}</span>
  <span class="ow">}</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">string_of_pair</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">p</span><span class="ow">,</span> <span class="n">string_of_item</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="s2">&quot;(&quot;</span> <span class="ow">++</span> <span class="n">string_of_item</span><span class="ow">(</span><span class="n">fst</span><span class="ow">(</span><span class="n">p</span><span class="ow">))</span> <span class="ow">++</span> <span class="s2">&quot;,&quot;</span> <span class="ow">++</span> <span class="n">string_of_item</span><span class="ow">(</span><span class="n">snd</span><span class="ow">(</span><span class="n">p</span><span class="ow">))</span> <span class="ow">++</span> <span class="s2">&quot;)&quot;</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">showPairs</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">),</span> <span class="n">string_of_node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="n">print_list</span><span class="ow">(</span><span class="n">pairs</span><span class="ow">,</span> <span class="n">p</span> <span class="ow">=&gt;</span> <span class="n">string_of_pair</span><span class="ow">(</span><span class="n">p</span><span class="ow">,</span> <span class="n">string_of_node</span><span class="ow">))</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">showAdjList</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">alist</span><span class="ow">),</span> <span class="n">string_of_node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="ow">(</span><span class="n">node</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="n">print_string</span><span class="ow">(</span><span class="n">string_of_node</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">++</span> <span class="s2">&quot;: &quot;</span><span class="ow">);</span>
      <span class="n">print_list</span><span class="ow">(</span><span class="n">alist</span><span class="ow">(</span><span class="n">node</span><span class="ow">),</span> <span class="n">string_of_node</span><span class="ow">)</span>
    <span class="ow">},</span> <span class="n">nodes</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">showAdjMatrix</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">amat</span><span class="ow">),</span> <span class="n">string_of_node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="ow">(</span><span class="n">i</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="n">print_string</span><span class="ow">(</span><span class="n">string_of_node</span><span class="ow">(</span><span class="n">i</span><span class="ow">)</span> <span class="ow">++</span> <span class="s2">&quot;:&quot;</span><span class="ow">);</span>
      <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="ow">(</span><span class="n">j</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="k">if</span> <span class="ow">(</span><span class="n">amat</span><span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">)))</span> <span class="ow">{</span>
            <span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot; 1&quot;</span><span class="ow">)</span>
          <span class="ow">}</span> <span class="k">else</span> <span class="ow">{</span>
            <span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot; 0&quot;</span><span class="ow">)</span>
          <span class="ow">}</span>
        <span class="ow">},</span> <span class="n">nodes</span><span class="ow">);</span>
      <span class="n">print_newline</span><span class="bp">()</span>
    <span class="ow">},</span> <span class="n">nodes</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Example 1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">nodes1</span> <span class="ow">=</span> <span class="ow">[</span><span class="mi">1</span><span class="ow">,</span> <span class="mi">2</span><span class="ow">,</span> <span class="mi">3</span><span class="ow">,</span> <span class="mi">4</span><span class="ow">];</span>
<span class="k">let</span> <span class="n">demoPairs1</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">nodes1</span><span class="ow">,</span> <span class="ow">[(</span><span class="mi">1</span><span class="ow">,</span> <span class="mi">1</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">1</span><span class="ow">,</span> <span class="mi">2</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">1</span><span class="ow">,</span> <span class="mi">3</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">1</span><span class="ow">,</span> <span class="mi">4</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">2</span><span class="ow">,</span> <span class="mi">2</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">2</span><span class="ow">,</span> <span class="mi">4</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">3</span><span class="ow">,</span> <span class="mi">3</span><span class="ow">),</span> <span class="ow">(</span><span class="mi">4</span><span class="ow">,</span> <span class="mi">4</span><span class="ow">)]);</span>
<span class="k">let</span> <span class="n">demoAdjList1</span> <span class="ow">=</span> <span class="n">adjlist_of_pairs</span><span class="ow">(</span><span class="n">demoPairs1</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">demoAdjMatrix1</span> <span class="ow">=</span><span class="n">adjmatrix_of_pairs</span><span class="ow">(</span><span class="n">demoPairs1</span><span class="ow">);</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Pairs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showPairs</span><span class="ow">(</span><span class="n">demoPairs1</span><span class="ow">,</span> <span class="n">string_of_int</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency List:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjList</span><span class="ow">(</span><span class="n">demoAdjList1</span><span class="ow">,</span> <span class="n">string_of_int</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjMatrix</span><span class="ow">(</span><span class="n">demoAdjMatrix1</span><span class="ow">,</span> <span class="n">string_of_int</span><span class="ow">);</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="k">type</span> <span class="n">t2</span> <span class="ow">=</span> <span class="nc">A</span> <span class="ow">|</span> <span class="nc">B</span> <span class="ow">|</span> <span class="nc">C</span> <span class="ow">|</span> <span class="nc">D</span><span class="ow">;</span>
<span class="k">let</span> <span class="n">nodes2</span> <span class="ow">=</span> <span class="ow">[</span><span class="nc">A</span><span class="ow">,</span> <span class="nc">B</span><span class="ow">,</span> <span class="nc">C</span><span class="ow">,</span> <span class="nc">D</span><span class="ow">];</span>
<span class="k">let</span> <span class="n">string_of_t2</span> <span class="ow">=</span> <span class="n">x</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">switch</span> <span class="ow">(</span><span class="n">x</span><span class="ow">)</span> <span class="ow">{</span>
  <span class="ow">|</span> <span class="nc">A</span> <span class="ow">=&gt;</span> <span class="s2">&quot;A&quot;</span>
  <span class="ow">|</span> <span class="nc">B</span> <span class="ow">=&gt;</span> <span class="s2">&quot;B&quot;</span>
  <span class="ow">|</span> <span class="nc">C</span> <span class="ow">=&gt;</span> <span class="s2">&quot;C&quot;</span>
  <span class="ow">|</span> <span class="nc">D</span> <span class="ow">=&gt;</span> <span class="s2">&quot;D&quot;</span>
  <span class="ow">}</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">demoAdjList2</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">nodes2</span><span class="ow">,</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
  <span class="ow">|</span> <span class="nc">A</span> <span class="ow">=&gt;</span> <span class="ow">[</span><span class="nc">B</span><span class="ow">,</span> <span class="nc">D</span><span class="ow">]</span>
  <span class="ow">|</span> <span class="nc">B</span> <span class="ow">=&gt;</span> <span class="ow">[</span><span class="nc">A</span><span class="ow">,</span> <span class="nc">C</span><span class="ow">]</span>
  <span class="ow">|</span> <span class="nc">C</span> <span class="ow">=&gt;</span> <span class="ow">[</span><span class="nc">B</span><span class="ow">]</span>
  <span class="ow">|</span> <span class="nc">D</span> <span class="ow">=&gt;</span> <span class="ow">[</span><span class="nc">A</span><span class="ow">]</span>
  <span class="ow">}</span>
<span class="ow">});</span>
<span class="k">let</span> <span class="n">demoPairs2</span> <span class="ow">=</span> <span class="n">pairs_of_adjlist</span><span class="ow">(</span><span class="n">demoAdjList2</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">demoAdjMatrix2</span> <span class="ow">=</span> <span class="n">adjmatrix_of_adjlist</span><span class="ow">(</span><span class="n">demoAdjList2</span><span class="ow">);</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Pairs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showPairs</span><span class="ow">(</span><span class="n">demoPairs2</span><span class="ow">,</span> <span class="n">string_of_t2</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency List:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjList</span><span class="ow">(</span><span class="n">demoAdjList2</span><span class="ow">,</span> <span class="n">string_of_t2</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjMatrix</span><span class="ow">(</span><span class="n">demoAdjMatrix2</span><span class="ow">,</span> <span class="n">string_of_t2</span><span class="ow">);</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 3</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">nodes3</span> <span class="ow">=</span> <span class="ow">[</span><span class="s2">&quot;red&quot;</span><span class="ow">,</span> <span class="s2">&quot;green&quot;</span><span class="ow">,</span> <span class="s2">&quot;yellow&quot;</span><span class="ow">];</span>
<span class="k">let</span> <span class="n">demoAdjMatrix3</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">nodes3</span><span class="ow">,</span> <span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">switch</span> <span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">j</span><span class="ow">))</span> <span class="ow">{</span>
  <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;red&quot;</span><span class="ow">,</span> <span class="s2">&quot;green&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="bp">true</span>
  <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;green&quot;</span><span class="ow">,</span> <span class="s2">&quot;yellow&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="bp">true</span>
  <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;yellow&quot;</span><span class="ow">,</span> <span class="s2">&quot;red&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="bp">true</span>
  <span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="bp">false</span>
  <span class="ow">}</span>
<span class="ow">});</span>
<span class="k">let</span> <span class="n">demoPairs3</span> <span class="ow">=</span> <span class="n">pairs_of_adjmatrix</span><span class="ow">(</span><span class="n">demoAdjMatrix3</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">demoAdjList3</span> <span class="ow">=</span> <span class="n">adjlist_of_adjmatrix</span><span class="ow">(</span><span class="n">demoAdjMatrix3</span><span class="ow">);</span>

<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Pairs</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showPairs</span><span class="ow">(</span><span class="n">demoPairs3</span><span class="ow">,</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency List:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjList</span><span class="ow">(</span><span class="n">demoAdjList3</span><span class="ow">,</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">);</span>
<span class="n">print_string</span><span class="ow">(</span><span class="s2">&quot;Adjacency Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="ow">);</span>
<span class="n">showAdjMatrix</span><span class="ow">(</span><span class="n">demoAdjMatrix3</span><span class="ow">,</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">);</span>
</pre></div>
</div>
<p>Here is a collection of functions to render a graph (represented as pairs) with DPoodle:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">graphLayout</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="ow">(</span><span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="ow">(</span><span class="kt">float</span><span class="ow">,</span> <span class="kt">float</span><span class="ow">))),</span> <span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">)));</span>

<span class="k">let</span> <span class="n">layoutCircle</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">),</span> <span class="n">radius</span><span class="ow">)=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">a</span> <span class="ow">=</span> <span class="mi">360</span><span class="ow">.</span> <span class="o">/.</span> <span class="n">float_of_int</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">length</span><span class="ow">(</span><span class="n">nodes</span><span class="ow">));</span>
  <span class="k">let</span> <span class="n">locs</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">mapi</span><span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">polar</span><span class="ow">(</span><span class="n">radius</span><span class="ow">,</span> <span class="n">a</span> <span class="ow">*.</span> <span class="n">float_of_int</span><span class="ow">(</span><span class="n">i</span><span class="ow">))),</span> <span class="n">nodes</span><span class="ow">);</span>
  <span class="ow">(</span><span class="n">locs</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">layoutGrid</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">),</span> <span class="n">columns</span><span class="ow">,</span> <span class="n">spacing</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">shift</span> <span class="ow">=</span> <span class="n">float_of_int</span><span class="ow">(</span><span class="n">columns</span> <span class="ow">-</span> <span class="mi">1</span><span class="ow">)</span> <span class="ow">*.</span> <span class="n">spacing</span> <span class="o">/.</span> <span class="mi">2</span><span class="ow">.;</span>
  <span class="k">let</span> <span class="n">locs</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">mapi</span><span class="ow">((</span><span class="n">i</span><span class="ow">,</span> <span class="n">node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="k">let</span> <span class="n">row</span> <span class="ow">=</span> <span class="n">i</span> <span class="o">/</span> <span class="n">columns</span><span class="ow">;</span>
      <span class="k">let</span> <span class="n">col</span> <span class="ow">=</span> <span class="n">i</span> <span class="ow">mod</span> <span class="n">columns</span><span class="ow">;</span>
      <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="ow">(</span><span class="n">float_of_int</span><span class="ow">(</span><span class="n">col</span><span class="ow">)</span> <span class="ow">*.</span> <span class="n">spacing</span> <span class="ow">-.</span> <span class="n">shift</span><span class="ow">,</span> <span class="n">float_of_int</span><span class="ow">(</span><span class="n">row</span><span class="ow">)</span> <span class="ow">*.</span> <span class="n">spacing</span><span class="ow">))</span>
    <span class="ow">},</span> <span class="n">nodes</span><span class="ow">);</span>
  <span class="ow">(</span><span class="n">locs</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">renderLayout</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">locs</span><span class="ow">,</span> <span class="n">pairs</span><span class="ow">),</span> <span class="n">string_of_node</span><span class="ow">,</span> <span class="n">styleNode</span><span class="ow">,</span> <span class="n">styleEdge</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">nodeRadius</span> <span class="ow">=</span> <span class="mi">10</span><span class="ow">.;</span>
  <span class="k">let</span> <span class="n">arrowLength</span> <span class="ow">=</span> <span class="mi">5</span><span class="ow">.;</span>
  <span class="k">let</span> <span class="n">arrowAngle</span> <span class="ow">=</span> <span class="n">radians</span><span class="ow">(</span><span class="mi">30</span><span class="ow">.);</span>
  <span class="k">let</span> <span class="n">loopOut</span> <span class="ow">=</span> <span class="n">radians</span><span class="ow">(</span><span class="mi">240</span><span class="ow">.);</span>
  <span class="k">let</span> <span class="n">loopIn</span> <span class="ow">=</span> <span class="n">radians</span><span class="ow">(</span><span class="mi">300</span><span class="ow">.);</span>
  <span class="k">let</span> <span class="n">nodes</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(((</span><span class="n">node</span><span class="ow">,</span> <span class="n">p</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="n">translateP</span><span class="ow">(</span><span class="n">p</span><span class="ow">,</span>
        <span class="n">styleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;none&quot;</span><span class="ow">),</span> <span class="n">fill</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;black&quot;</span><span class="ow">),</span> <span class="n">text</span><span class="ow">(</span><span class="n">string_of_node</span><span class="ow">(</span><span class="n">node</span><span class="ow">))))</span>
        <span class="ow">+++</span> <span class="n">circle</span><span class="ow">(</span><span class="n">nodeRadius</span><span class="ow">)))</span>
    <span class="ow">},</span> <span class="n">locs</span><span class="ow">);</span>
  <span class="k">let</span> <span class="n">edges</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="ow">(((</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
      <span class="k">if</span> <span class="ow">(</span><span class="n">n1</span> <span class="ow">==</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
        <span class="k">let</span> <span class="n">p</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">assoc</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">locs</span><span class="ow">);</span>
        <span class="k">let</span> <span class="ow">(</span><span class="n">x</span><span class="ow">,</span> <span class="n">y</span><span class="ow">)</span> <span class="ow">=</span> <span class="n">p</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">p1</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x</span> <span class="ow">+.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopOut</span><span class="ow">),</span> <span class="n">y</span> <span class="ow">+.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopOut</span><span class="ow">));</span>
        <span class="k">let</span> <span class="n">p2</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x</span> <span class="ow">+.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopIn</span><span class="ow">),</span> <span class="n">y</span> <span class="ow">+.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopIn</span><span class="ow">));</span>
        <span class="k">let</span> <span class="n">c1</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x</span> <span class="ow">+.</span> <span class="mi">3</span><span class="ow">.</span> <span class="ow">*.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopOut</span><span class="ow">),</span> <span class="n">y</span> <span class="ow">+.</span> <span class="mi">3</span><span class="ow">.</span> <span class="ow">*.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopOut</span><span class="ow">));</span>
        <span class="k">let</span> <span class="n">c2</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x</span> <span class="ow">+.</span> <span class="mi">3</span><span class="ow">.</span> <span class="ow">*.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopIn</span><span class="ow">),</span> <span class="n">y</span> <span class="ow">+.</span> <span class="mi">3</span><span class="ow">.</span> <span class="ow">*.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopIn</span><span class="ow">));</span>
        <span class="k">let</span> <span class="ow">(</span><span class="n">x2</span><span class="ow">,</span> <span class="n">y2</span><span class="ow">)</span> <span class="ow">=</span> <span class="n">p2</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">p3</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x2</span> <span class="ow">+.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopIn</span> <span class="ow">+.</span> <span class="n">arrowAngle</span><span class="ow">),</span> <span class="n">y2</span> <span class="ow">+.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopIn</span> <span class="ow">+.</span> <span class="n">arrowAngle</span><span class="ow">));</span>
        <span class="k">let</span> <span class="n">p4</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x2</span> <span class="ow">+.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">loopIn</span> <span class="ow">-.</span> <span class="n">arrowAngle</span><span class="ow">),</span> <span class="n">y2</span> <span class="ow">+.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">loopIn</span> <span class="ow">-.</span> <span class="n">arrowAngle</span><span class="ow">));</span>
        <span class="n">setBounds</span><span class="ow">(</span><span class="n">x</span> <span class="ow">-.</span> <span class="n">nodeRadius</span><span class="ow">,</span> <span class="n">x</span> <span class="ow">+.</span> <span class="n">nodeRadius</span><span class="ow">,</span> <span class="n">y</span> <span class="ow">-.</span> <span class="mi">2</span><span class="ow">.</span> <span class="ow">*.</span> <span class="n">nodeRadius</span><span class="ow">,</span> <span class="n">y</span> <span class="ow">+.</span> <span class="n">nodeRadius</span><span class="ow">,</span>
          <span class="n">styleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">,</span> <span class="n">openPath</span><span class="ow">([</span><span class="n">moveP</span><span class="ow">(</span><span class="n">p1</span><span class="ow">),</span> <span class="n">curveP</span><span class="ow">(</span><span class="n">c1</span><span class="ow">,</span> <span class="n">c2</span><span class="ow">,</span> <span class="n">p2</span><span class="ow">),</span> <span class="n">moveP</span><span class="ow">(</span><span class="n">p2</span><span class="ow">),</span> <span class="n">lineP</span><span class="ow">(</span><span class="n">p3</span><span class="ow">),</span> <span class="n">moveP</span><span class="ow">(</span><span class="n">p2</span><span class="ow">),</span> <span class="n">lineP</span><span class="ow">(</span><span class="n">p4</span><span class="ow">)])))</span>
      <span class="ow">}</span> <span class="k">else</span> <span class="ow">{</span>
        <span class="k">let</span> <span class="n">p1</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">assoc</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">locs</span><span class="ow">);</span>
        <span class="k">let</span> <span class="n">p2</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">assoc</span><span class="ow">(</span><span class="n">n2</span><span class="ow">,</span> <span class="n">locs</span><span class="ow">);</span>
        <span class="k">let</span> <span class="ow">(</span><span class="n">x1</span><span class="ow">,</span> <span class="n">y1</span><span class="ow">)</span> <span class="ow">=</span> <span class="n">p1</span><span class="ow">;</span>
        <span class="k">let</span> <span class="ow">(</span><span class="n">x2</span><span class="ow">,</span> <span class="n">y2</span><span class="ow">)</span> <span class="ow">=</span> <span class="n">p2</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">dx</span> <span class="ow">=</span> <span class="n">x2</span> <span class="ow">-.</span> <span class="n">x1</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">dy</span> <span class="ow">=</span> <span class="n">y2</span> <span class="ow">-.</span> <span class="n">y1</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">atan2</span><span class="ow">(</span><span class="n">dy</span><span class="ow">,</span> <span class="n">dx</span><span class="ow">);</span>
        <span class="k">let</span> <span class="n">p3</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x2</span> <span class="ow">-.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">a</span><span class="ow">),</span> <span class="n">y2</span> <span class="ow">-.</span> <span class="n">nodeRadius</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">a</span><span class="ow">));</span>
        <span class="k">let</span> <span class="ow">(</span><span class="n">x3</span><span class="ow">,</span> <span class="n">y3</span><span class="ow">)</span> <span class="ow">=</span> <span class="n">p3</span><span class="ow">;</span>
        <span class="k">let</span> <span class="n">p4</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x3</span> <span class="ow">-.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">a</span> <span class="ow">+.</span> <span class="n">arrowAngle</span><span class="ow">),</span> <span class="n">y3</span> <span class="ow">-.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">a</span> <span class="ow">+.</span> <span class="n">arrowAngle</span><span class="ow">));</span>
        <span class="k">let</span> <span class="n">p5</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">x3</span> <span class="ow">-.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">cos</span><span class="ow">(</span><span class="n">a</span> <span class="ow">-.</span> <span class="n">arrowAngle</span><span class="ow">),</span> <span class="n">y3</span> <span class="ow">-.</span> <span class="n">arrowLength</span> <span class="ow">*.</span> <span class="n">sin</span><span class="ow">(</span><span class="n">a</span> <span class="ow">-.</span> <span class="n">arrowAngle</span><span class="ow">));</span>
        <span class="n">styleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">,</span> <span class="n">openPath</span><span class="ow">([</span><span class="n">moveP</span><span class="ow">(</span><span class="n">p1</span><span class="ow">),</span> <span class="n">lineP</span><span class="ow">(</span><span class="n">p2</span><span class="ow">),</span> <span class="n">moveP</span><span class="ow">(</span><span class="n">p3</span><span class="ow">),</span> <span class="n">lineP</span><span class="ow">(</span><span class="n">p4</span><span class="ow">),</span> <span class="n">moveP</span><span class="ow">(</span><span class="n">p3</span><span class="ow">),</span> <span class="n">lineP</span><span class="ow">(</span><span class="n">p5</span><span class="ow">)]))</span>
      <span class="ow">}</span>
    <span class="ow">},</span> <span class="n">pairs</span><span class="ow">);</span>
  <span class="k">let</span> <span class="n">nodeImage</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span><span class="ow">((+++),</span> <span class="n">empty</span><span class="ow">,</span> <span class="n">nodes</span><span class="ow">);</span>
  <span class="k">let</span> <span class="n">edgeImage</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span><span class="ow">((+++),</span> <span class="n">empty</span><span class="ow">,</span> <span class="n">edges</span><span class="ow">);</span>
  <span class="n">nodeImage</span> <span class="ow">+++</span> <span class="n">edgeImage</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">defaultStyleNode</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">img</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;black&quot;</span><span class="ow">),</span> <span class="n">fill</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;white&quot;</span><span class="ow">),</span> <span class="n">img</span><span class="ow">))</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">defaultStyleEdge</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">,</span> <span class="n">img</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;black&quot;</span><span class="ow">),</span> <span class="n">img</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="k">let</span> <span class="n">customStyleNode</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">img</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">fillColor</span> <span class="ow">=</span> <span class="nc">Color</span><span class="ow">(</span><span class="n">node</span><span class="ow">);</span>
  <span class="n">withFont</span><span class="ow">(</span><span class="mi">0</span><span class="ow">.</span><span class="mi">4</span><span class="ow">,</span> <span class="nc">Sans</span><span class="ow">,</span> <span class="nc">Regular</span><span class="ow">,</span> <span class="nc">Normal</span><span class="ow">,</span> <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;black&quot;</span><span class="ow">),</span> <span class="n">fill</span><span class="ow">(</span><span class="n">fillColor</span><span class="ow">,</span> <span class="n">img</span><span class="ow">)))</span>
<span class="ow">};</span>

<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demoPairs1</span><span class="ow">,</span> <span class="mi">50</span><span class="ow">.),</span> <span class="n">string_of_int</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutGrid</span><span class="ow">(</span><span class="n">demoPairs2</span><span class="ow">,</span> <span class="mi">3</span><span class="ow">,</span> <span class="mi">50</span><span class="ow">.),</span> <span class="n">string_of_t2</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demoPairs3</span><span class="ow">,</span> <span class="mi">50</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">customStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
</div>
<div class="section" id="graph-traversals">
<h2>Graph Traversals<a class="headerlink" href="#graph-traversals" title="Permalink to this headline">¶</a></h2>
<p>We will consider two main ways of traversing a graph here.
In addition to visiting all of the nodes in the graph, each approach will allow us to answer some extra questions about the structure of the graph.
The <strong>depth-first traversal</strong> is analogous to the pre-, in-, and postorder traversals of a tree, in the sense that we will (recursively) visit all of the nodes reachable from one neighbor before backing up and trying another neighbor.
The <strong>breadth-first traversal</strong> by contrast is analogous to the level order traversal of a tree, where we will visit all of the immediate neighbors before continuing on to visit <em>their</em> neighbors, and so on.
Just as with level order traversal, the breadth-first traversal does not have as natural a recursive implementation as depth-first, although we will see that both can be expressed with very similar code by making use of an explicit data structure to control the traversal.
Graph traversals in general are more complicated than tree traversals, because we have to worry about <strong>sharing</strong> of descendants of a node (there may be multiple paths to reach the same node) as well as <strong>cycles</strong> in the graph (there may be paths that loop back on themselves).
Indeed, one definition of a tree is that it is a graph with a distinguished node, called the root, such that there is a unique path from the root to any other node.</p>
<div class="section" id="depth-first-traversal">
<h3>Depth-First Traversal<a class="headerlink" href="#depth-first-traversal" title="Permalink to this headline">¶</a></h3>
<p>To perform a depth-first traversal, we will need to keep track of two additional pieces of information about the nodes.
The first is a set of <strong>visited</strong> nodes; whenever we first arrive at a node, we add it to this set.
The other is the <strong>finishing list</strong>; whenever we have finished examining all of a node’s neighbors, we will add it to the head of the finishing list.
When working with a graphical representation, we will color in a node when it is first visited, and then write a number (the <strong>finishing number</strong>) next to the node when it is finished showing its position from the end of the finishing list.
This information corresponds to performing actions according to <em>preorder</em> (visiting) and <em>postorder</em> (finishing) traversal of a tree.[^There is no analogue to <em>inorder</em>, because we don’t impose any order on the neighbors of a node, so there is no equivalent of having finished the left child and being about to start the right child.]</p>
<p>Here is the basic algorithm for depth-first traversal starting from a node <span class="math notranslate nohighlight">\(n\)</span>:</p>
<ul class="simple">
<li><p>Mark <span class="math notranslate nohighlight">\(n\)</span> as visited</p></li>
<li><p>While there is an adjacent unvisited node, <span class="math notranslate nohighlight">\(p\)</span></p>
<ul>
<li><p>Perform a depth-first traversal starting from <span class="math notranslate nohighlight">\(p\)</span></p></li>
</ul>
</li>
<li><p>When all nodes adjacent to <span class="math notranslate nohighlight">\(n\)</span> are visited, add <span class="math notranslate nohighlight">\(n\)</span> to the head of the finishing list.</p></li>
</ul>
<p>To traverse all of the nodes in a graph, first choose an arbitrary node and perform a depth-first traversal starting from that node. When that node is finished, if there are any remaining unvisited nodes then choose one and repeat.</p>
<p>Clearly this procedure will eventually visit all of the nodes exactly once.
By keeping track of a little more information, it can also answer some interesting questions about a graph.
As we are traversing the graph, we will put each edge into one of three categories:</p>
<ul class="simple">
<li><p><strong>Tree Edge</strong>: an edge that we follow to get to an adjacent unvisited node</p></li>
<li><p><strong>Back Edge</strong>: an edge that we do not follow because it leads to a visited, <em>but not yet finished</em>, node</p></li>
<li><p><strong>Forward Edge</strong>: an edge that we do not follow because it leads to an already finished node[^Some authors distinguish between proper forward edges, where there is a path of tree edges leading from the current node to the already finished node, and <strong>cross edges</strong>, where there is not such a path, but we will not need that distinction.]</p></li>
</ul>
<p>Here then is the augmented algorithm for depth-first traversal from <span class="math notranslate nohighlight">\(n\)</span>:</p>
<ul class="simple">
<li><p>Mark <span class="math notranslate nohighlight">\(n\)</span> as visited</p></li>
<li><p>For each edge <span class="math notranslate nohighlight">\(e\)</span> coming out of <span class="math notranslate nohighlight">\(n\)</span> and going to a node <span class="math notranslate nohighlight">\(p\)</span>:</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(p\)</span> is unvisited, perform a depth-first traversal from <span class="math notranslate nohighlight">\(p\)</span> and mark <span class="math notranslate nohighlight">\(e\)</span> as a tree edge</p></li>
<li><p>If <span class="math notranslate nohighlight">\(p\)</span> is visited but not yet finished, mark <span class="math notranslate nohighlight">\(e\)</span> as a back edge</p></li>
<li><p>If <span class="math notranslate nohighlight">\(p\)</span> is finished, mark <span class="math notranslate nohighlight">\(e\)</span> as a forward edge</p></li>
</ul>
</li>
<li><p>Add <span class="math notranslate nohighlight">\(n\)</span> to the finishing list.</p></li>
</ul>
<p>The tree edges form what is known as the <strong>depth-first search tree</strong>, with the root at the node where we started the traversal.
More generally, since we get a separate tree each time we restart the traversal, the result of visiting all of the nodes in a graph will in general be a <strong>depth-first search forest</strong> (since a <strong>forest</strong> is just a set of trees).</p>
<p>If we ever find a back edge in traversing a graph, then the graph has a cycle.
Suppose that there is a back edge from <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(p\)</span>. Since <span class="math notranslate nohighlight">\(p\)</span> is visited but not yet finished, there must be a sequence of tree edges leading from <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(n\)</span> (the current path we are exploring).
That path plus the back edge will form a cycle.
Conversely, if a graph has a cycle, then we will find at least one back edge, because there will be some point in the traversal where we close the loop back to a node on the current path (which will necessarily be visited but not yet finished).</p>
<p>On the other hand, if we find no back edges, then the graph is <strong>acyclic</strong>.
Directed acyclic graphs (often called <strong>dags</strong>) share many of the advantages of trees; indeed, we have already encountered them as combinational circuits, which we viewed as a generalization of boolean expression trees (with shared subterms).
They are also useful to model dependencies, for example showing which tasks must be completed before others (such as prerequisite courses in a college catalog).</p>
<p>Given an acyclic graph, we may “linearize” the nodes by choosing an order in which to list them that respects the dependencies among them (for example, an order in which to take a sequence of classes where all the prerequisites are taken before the courses that depend on them).
This is a generalization of sorting, where the edges in the graph reflect only a “partial” ordering among the items; it is known as <strong>topological sorting</strong>, and the result is a <strong>topological ordering</strong> of the nodes.
The perhaps surprising fact about the finishing list is that, if there were no cycles, then it gives a topological ordering!
The reason is that we can finish a node only after all of the nodes that can be reached from it are finished, so when we put it at the front of the finishing list it will be followed by all of the nodes that depend on it.</p>
<p>As an example of depth-first traversal, consider the following graph:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">demo</span> <span class="ow">=</span> <span class="ow">([</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">],</span>
  <span class="ow">[(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">)]);</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
<p>Start by marking <span class="math notranslate nohighlight">\(A\)</span> visited:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">visitedNode</span> <span class="ow">=</span> <span class="n">fill</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;yellow&quot;</span><span class="ow">));</span>
<span class="k">let</span> <span class="n">finishedNode</span> <span class="ow">=</span> <span class="n">n</span> <span class="ow">=&gt;</span> <span class="n">img</span> <span class="ow">=&gt;</span> <span class="n">fill</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;cyan&quot;</span><span class="ow">),</span>
  <span class="n">img</span> <span class="ow">+++</span> <span class="n">translate</span><span class="ow">(</span><span class="mi">8</span><span class="ow">.,</span> <span class="mi">12</span><span class="ow">.,</span> <span class="n">withFont</span><span class="ow">(</span><span class="mi">0</span><span class="ow">.</span><span class="mi">4</span><span class="ow">,</span> <span class="nc">Serif</span><span class="ow">,</span> <span class="nc">Regular</span><span class="ow">,</span> <span class="nc">Normal</span><span class="ow">,</span> <span class="n">fill</span><span class="ow">(</span><span class="n">color</span><span class="ow">(</span><span class="s2">&quot;black&quot;</span><span class="ow">),</span> <span class="n">text</span><span class="ow">(</span><span class="n">string_of_int</span><span class="ow">(</span><span class="n">n</span><span class="ow">))))));</span>
<span class="k">let</span> <span class="n">treeEdge</span> <span class="ow">=</span> <span class="n">strokeWidth</span><span class="ow">(</span><span class="mi">3</span><span class="ow">.</span><span class="mi">0</span><span class="ow">);</span>
<span class="k">let</span> <span class="n">backEdge</span> <span class="ow">=</span> <span class="n">img</span> <span class="ow">=&gt;</span> <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;red&quot;</span><span class="ow">),</span> <span class="n">strokeWidth</span><span class="ow">(</span><span class="mi">2</span><span class="ow">.</span><span class="mi">0</span><span class="ow">,</span> <span class="n">img</span><span class="ow">));</span>
<span class="k">let</span> <span class="n">forwardEdge</span> <span class="ow">=</span> <span class="n">img</span> <span class="ow">=&gt;</span> <span class="n">stroke</span><span class="ow">(</span><span class="nc">Color</span><span class="ow">(</span><span class="s2">&quot;green&quot;</span><span class="ow">),</span> <span class="n">strokeWidth</span><span class="ow">(</span><span class="mi">2</span><span class="ow">.</span><span class="mi">0</span><span class="ow">,</span> <span class="n">img</span><span class="ow">));</span>
<span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="n">defaultStyleEdge</span><span class="ow">;</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Follow the (tree) edge to <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Follow the (tree) edge from <span class="math notranslate nohighlight">\(B\)</span> to <span class="math notranslate nohighlight">\(C\)</span>:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Node <span class="math notranslate nohighlight">\(C\)</span> has no neighbors at all, so mark it finished:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Back at node <span class="math notranslate nohighlight">\(B\)</span>, follow the (tree) edge to <span class="math notranslate nohighlight">\(D\)</span>:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>The only edge out of <span class="math notranslate nohighlight">\(D\)</span> goes to <span class="math notranslate nohighlight">\(A\)</span>, which is visited but not yet finished, so mark it as a back edge and mark <span class="math notranslate nohighlight">\(D\)</span> finished:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">backEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Now node <span class="math notranslate nohighlight">\(B\)</span> is also finished, so back up to node <span class="math notranslate nohighlight">\(A\)</span> and consider its remaining outward edge.
It goes to node <span class="math notranslate nohighlight">\(C\)</span>, which is already finished, so mark it as a forward edge and mark <span class="math notranslate nohighlight">\(A\)</span> finished as well:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">4</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">3</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">backEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">forwardEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>We still have nodes <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(F\)</span> unvisited. Arbitrarily restart the traversal at <span class="math notranslate nohighlight">\(E\)</span>, and first consider the edge to <span class="math notranslate nohighlight">\(C\)</span>. Since <span class="math notranslate nohighlight">\(C\)</span> is already finished, this is another forward edge:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">4</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">3</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;E&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">backEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">forwardEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Now follow the tree edge from <span class="math notranslate nohighlight">\(E\)</span> to <span class="math notranslate nohighlight">\(F\)</span>, and find the edge from <span class="math notranslate nohighlight">\(F\)</span> to <span class="math notranslate nohighlight">\(D\)</span> is a forward edge:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">4</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">3</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;E&quot;</span> <span class="ow">|</span> <span class="s2">&quot;F&quot;</span> <span class="ow">=&gt;</span> <span class="n">visitedNode</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">backEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">forwardEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Finally, the edge from <span class="math notranslate nohighlight">\(F\)</span> to itself is a back edge, after which <span class="math notranslate nohighlight">\(F\)</span> and then <span class="math notranslate nohighlight">\(E\)</span> are finished:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">4</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">3</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;E&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">6</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;F&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">5</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">backEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">forwardEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>Since there were back edges, the graph has at least one cycle. In fact, there are two: <span class="math notranslate nohighlight">\(A\rightarrow B\rightarrow D\rightarrow A\)</span>, and <span class="math notranslate nohighlight">\(F\rightarrow F\)</span>. In general, there may not be an exact match between the number of back edges and the number of cycles, because several cycles may share a single back edge.</p>
<p>For another example, here is the same graph with the edges <span class="math notranslate nohighlight">\(D\rightarrow A\)</span> and <span class="math notranslate nohighlight">\(F\rightarrow F\)</span> removed:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">demo2</span> <span class="ow">=</span> <span class="ow">([</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">],</span>
  <span class="ow">[(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)]);</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo2</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
<p>We leave the details of tracing through the traversal as an exercise, but here is the final marked graph:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ns</span> <span class="ow">=</span> <span class="n">node</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="s2">&quot;A&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">4</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;B&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">3</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;C&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">1</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;D&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">2</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;E&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">6</span><span class="ow">)</span>
<span class="ow">|</span> <span class="s2">&quot;F&quot;</span> <span class="ow">=&gt;</span> <span class="n">finishedNode</span><span class="ow">(</span><span class="mi">5</span><span class="ow">)</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleNode</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="k">let</span> <span class="n">es</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="k">switch</span> <span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">{</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">treeEdge</span>
<span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">)</span> <span class="ow">|</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">forwardEdge</span>
<span class="ow">|</span> <span class="ow">_</span> <span class="ow">=&gt;</span> <span class="n">defaultStyleEdge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span>
<span class="ow">};</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">demo2</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">ns</span><span class="ow">,</span> <span class="n">es</span><span class="ow">));</span>
</pre></div>
</div>
<p>The finishing list is <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(D\)</span>, <span class="math notranslate nohighlight">\(C\)</span> in this case. Since there were no back edges, this is a topological ordering of the nodes in the graph. Here is the graph with the nodes reordered:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">demo3</span> <span class="ow">=</span> <span class="ow">([</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">],</span>
  <span class="ow">[(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;E&quot;</span><span class="ow">,</span> <span class="s2">&quot;F&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;F&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">)]);</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutGrid</span><span class="ow">(</span><span class="n">demo3</span><span class="ow">,</span> <span class="mi">6</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
<p>Observe that all of the arrows go from left to right. (<strong>TODO</strong> This diagram will look better when the rendering function can use curved arrows to avoid overlap….)</p>
<p>Note that other markings are possible, depending on the choices made (which nodes to start at, and the order in which to visit the edges out of each node). As another exercise, perform another traversal of this graph that produces a different marked-up result. Can you find a different topological ordering?</p>
</div>
<div class="section" id="reasonml-implementation-of-depth-first-traversal">
<h3>ReasonML Implementation of Depth-First Traversal<a class="headerlink" href="#reasonml-implementation-of-depth-first-traversal" title="Permalink to this headline">¶</a></h3>
<p>To write the depth-first traversal as a pure functional program, we do not want to store the extra information (visited and finished lists, and the categorization of the edges) in mutable data structures.
Instead, we will pass around a ReasonML <strong>record</strong> containing the state.
The syntax for records is very much like that in JavaScript: it consists of a comma-separated set of fields of the form <code class="docutils literal notranslate"><span class="pre">label:</span> <span class="pre">value</span></code> inside a pair of curly brackets.
To access the field <code class="docutils literal notranslate"><span class="pre">x</span></code> of record <code class="docutils literal notranslate"><span class="pre">r</span></code> we use <code class="docutils literal notranslate"><span class="pre">r.x</span></code>.
To create a new record as a copy of <code class="docutils literal notranslate"><span class="pre">r</span></code>, with field <code class="docutils literal notranslate"><span class="pre">x</span></code> updated to <code class="docutils literal notranslate"><span class="pre">v</span></code>, we write <code class="docutils literal notranslate"><span class="pre">{...r,</span> <span class="pre">x:</span> <span class="pre">v}</span></code>.</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">state</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="ow">{</span>
  <span class="n">visited</span><span class="ow">:</span> <span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">),</span>
  <span class="n">finished</span><span class="ow">:</span> <span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">),</span>
  <span class="n">tree</span><span class="ow">:</span> <span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">)),</span>
  <span class="n">forward</span><span class="ow">:</span> <span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">)),</span>
  <span class="n">back</span><span class="ow">:</span> <span class="kt">list</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">))</span>
<span class="ow">};</span>

<span class="k">type</span> <span class="n">dfsResult</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="nc">Cycle</span><span class="ow">((</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">))</span> <span class="ow">|</span> <span class="nc">TopoOrder</span><span class="ow">(</span><span class="kt">list</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">));</span>

<span class="k">let</span> <span class="n">depthFirst</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">adjList</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">chooseUnvisited</span> <span class="ow">=</span> <span class="n">visited</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
    <span class="k">let</span> <span class="n">unvisited</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="ow">(</span><span class="n">node</span> <span class="ow">=&gt;</span> <span class="o">!</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">visited</span><span class="ow">)),</span> <span class="n">nodes</span><span class="ow">);</span>
    <span class="k">switch</span> <span class="ow">(</span><span class="n">unvisited</span><span class="ow">)</span> <span class="ow">{</span>
    <span class="ow">|</span> <span class="bp">[]</span> <span class="ow">=&gt;</span> <span class="nc">None</span>
    <span class="ow">|</span> <span class="ow">[</span><span class="n">head</span><span class="ow">,</span> <span class="ow">..._]</span> <span class="ow">=&gt;</span> <span class="nc">Some</span><span class="ow">(</span><span class="n">head</span><span class="ow">)</span>
    <span class="ow">}</span>
  <span class="ow">};</span>

  <span class="k">let</span> <span class="k">rec</span> <span class="n">dfs</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">state</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
    <span class="k">let</span> <span class="n">neighbors</span> <span class="ow">=</span> <span class="n">adjList</span><span class="ow">(</span><span class="n">node</span><span class="ow">);</span>
    <span class="k">let</span> <span class="n">state&#39;</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span><span class="ow">((</span><span class="n">s</span><span class="ow">,</span> <span class="n">n</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
        <span class="k">if</span> <span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">n</span><span class="ow">,</span> <span class="n">s</span><span class="ow">.</span><span class="n">finished</span><span class="ow">))</span> <span class="ow">{</span>
          <span class="ow">{...</span><span class="n">s</span><span class="ow">,</span> <span class="n">forward</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">node</span><span class="ow">,</span> <span class="n">n</span><span class="ow">),</span> <span class="ow">...</span><span class="n">s</span><span class="ow">.</span><span class="n">forward</span><span class="ow">]}</span>
        <span class="ow">}</span> <span class="k">else</span> <span class="k">if</span> <span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">n</span><span class="ow">,</span> <span class="n">s</span><span class="ow">.</span><span class="n">visited</span><span class="ow">))</span> <span class="ow">{</span>
          <span class="ow">{...</span><span class="n">s</span><span class="ow">,</span> <span class="n">back</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">node</span><span class="ow">,</span> <span class="n">n</span><span class="ow">),</span> <span class="ow">...</span><span class="n">s</span><span class="ow">.</span><span class="n">back</span><span class="ow">]}</span>
        <span class="ow">}</span> <span class="k">else</span> <span class="ow">{</span>
          <span class="k">let</span> <span class="n">s&#39;</span> <span class="ow">=</span> <span class="n">dfs</span><span class="ow">(</span><span class="n">n</span><span class="ow">,</span> <span class="n">s</span><span class="ow">);</span>
          <span class="ow">{...</span><span class="n">s&#39;</span><span class="ow">,</span> <span class="n">tree</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">node</span><span class="ow">,</span> <span class="n">n</span><span class="ow">),</span> <span class="ow">...</span><span class="n">s&#39;</span><span class="ow">.</span><span class="n">tree</span><span class="ow">]}</span>
        <span class="ow">}</span>
      <span class="ow">},</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">visited</span><span class="ow">:</span> <span class="ow">[</span><span class="n">node</span><span class="ow">,</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">visited</span><span class="ow">]},</span> <span class="n">neighbors</span><span class="ow">);</span>
    <span class="ow">{...</span><span class="n">state&#39;</span><span class="ow">,</span> <span class="n">finished</span><span class="ow">:</span> <span class="ow">[</span><span class="n">node</span><span class="ow">,</span> <span class="ow">...</span><span class="n">state&#39;</span><span class="ow">.</span><span class="n">finished</span><span class="ow">]}</span>
  <span class="ow">};</span>

  <span class="k">let</span> <span class="k">rec</span> <span class="n">run</span> <span class="ow">=</span> <span class="n">state</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
    <span class="k">switch</span> <span class="ow">(</span><span class="n">chooseUnvisited</span><span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">visited</span><span class="ow">))</span> <span class="ow">{</span>
    <span class="ow">|</span> <span class="nc">None</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
        <span class="k">let</span> <span class="n">t</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">state</span><span class="ow">.</span><span class="n">tree</span><span class="ow">);</span>
        <span class="k">switch</span> <span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">back</span><span class="ow">)</span> <span class="ow">{</span>
        <span class="ow">|</span> <span class="bp">[]</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="nc">TopoOrder</span><span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">finished</span><span class="ow">),</span> <span class="n">t</span><span class="ow">)</span>
        <span class="ow">|</span> <span class="ow">[</span><span class="n">e</span><span class="ow">,</span> <span class="ow">..._]</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="nc">Cycle</span><span class="ow">(</span><span class="n">e</span><span class="ow">),</span> <span class="n">t</span><span class="ow">)</span>
        <span class="ow">}</span>
      <span class="ow">}</span>
    <span class="ow">|</span> <span class="nc">Some</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="n">run</span><span class="ow">(</span><span class="n">dfs</span><span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">state</span><span class="ow">))</span>
    <span class="ow">}</span>
  <span class="ow">};</span>

  <span class="k">let</span> <span class="n">initialState</span> <span class="ow">=</span> <span class="ow">{</span>
    <span class="n">visited</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">finished</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">tree</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">forward</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">back</span><span class="ow">:</span> <span class="bp">[]</span>
  <span class="ow">};</span>

  <span class="n">run</span><span class="ow">(</span><span class="n">initialState</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="n">depthFirst</span><span class="ow">(</span><span class="n">adjlist_of_pairs</span><span class="ow">(</span><span class="n">demo</span><span class="ow">));</span>
<span class="n">depthFirst</span><span class="ow">(</span><span class="n">adjlist_of_pairs</span><span class="ow">(</span><span class="n">demo2</span><span class="ow">));</span>
</pre></div>
</div>
<p>The returned value from <code class="docutils literal notranslate"><span class="pre">depthFirst</span></code> is a pair of a <code class="docutils literal notranslate"><span class="pre">dfsResult</span></code> and a <code class="docutils literal notranslate"><span class="pre">graphPairs</span></code>.
The <code class="docutils literal notranslate"><span class="pre">dfsResult</span></code> is either <code class="docutils literal notranslate"><span class="pre">Cycle(e)</span></code>, where <code class="docutils literal notranslate"><span class="pre">e</span></code> is a back edge (pair of nodes) causing a cycle, or <code class="docutils literal notranslate"><span class="pre">TopoOrder(nodes)</span></code>, where <code class="docutils literal notranslate"><span class="pre">nodes</span></code> is a list of the graph nodes in topological order.
The <code class="docutils literal notranslate"><span class="pre">graphPairs</span></code> value is the subgraph consisting of just the tree nodes.</p>
<p>Instead of using the recursive helper function <code class="docutils literal notranslate"><span class="pre">dfs</span></code>, which performs a single depth-first exploration starting from a given node, we may perform all of the exploration in the (tail-recursive) helper function <code class="docutils literal notranslate"><span class="pre">run</span></code> by using an explicit stack to keep track of the current path from the starting node. Each entry in the stack can be one of three values: <code class="docutils literal notranslate"><span class="pre">Visit(n)</span></code> says that the current task is to visit node <code class="docutils literal notranslate"><span class="pre">n</span></code>; <code class="docutils literal notranslate"><span class="pre">Finish(n)</span></code> says that the current task is to finish node <code class="docutils literal notranslate"><span class="pre">n</span></code> (note that this is pushed on the stack underneath all of the edges out of <code class="docutils literal notranslate"><span class="pre">n</span></code>, so it will only be done after all of the neighbors are processed); and <code class="docutils literal notranslate"><span class="pre">Edge(n1,</span> <span class="pre">n2)</span></code> says that the current task is to consider the edge from <code class="docutils literal notranslate"><span class="pre">n1</span></code> to <code class="docutils literal notranslate"><span class="pre">n2</span></code>. The <code class="docutils literal notranslate"><span class="pre">run</span></code> helper function can now be seen as a loop that continually removes a task from the stack and then updates the stack and the state to perform that task:</p>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">dfsStackItem</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=</span> <span class="nc">Visit</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">|</span> <span class="nc">Finish</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">)</span> <span class="ow">|</span> <span class="nc">Edge</span><span class="ow">(</span><span class="k">&#39;</span><span class="n">n</span><span class="ow">,</span> <span class="k">&#39;</span><span class="n">n</span><span class="ow">);</span>

<span class="k">let</span> <span class="n">depthFirst2</span> <span class="ow">=</span> <span class="ow">((</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">adjList</span><span class="ow">))</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
  <span class="k">let</span> <span class="n">chooseUnvisited</span> <span class="ow">=</span> <span class="n">visited</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
    <span class="k">let</span> <span class="n">unvisited</span> <span class="ow">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="ow">(</span><span class="n">node</span> <span class="ow">=&gt;</span> <span class="o">!</span><span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">node</span><span class="ow">,</span> <span class="n">visited</span><span class="ow">)),</span> <span class="n">nodes</span><span class="ow">);</span>
    <span class="k">switch</span> <span class="ow">(</span><span class="n">unvisited</span><span class="ow">)</span> <span class="ow">{</span>
    <span class="ow">|</span> <span class="bp">[]</span> <span class="ow">=&gt;</span> <span class="nc">None</span>
    <span class="ow">|</span> <span class="ow">[</span><span class="n">head</span><span class="ow">,</span> <span class="ow">..._]</span> <span class="ow">=&gt;</span> <span class="nc">Some</span><span class="ow">(</span><span class="n">head</span><span class="ow">)</span>
    <span class="ow">}</span>
  <span class="ow">};</span>

  <span class="k">let</span> <span class="k">rec</span> <span class="n">run</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="n">state</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
    <span class="k">if</span> <span class="ow">(</span><span class="nn">Stack</span><span class="p">.</span><span class="n">is_empty</span><span class="ow">(</span><span class="n">stack</span><span class="ow">))</span> <span class="ow">{</span>
      <span class="k">switch</span> <span class="ow">(</span><span class="n">chooseUnvisited</span><span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">visited</span><span class="ow">))</span> <span class="ow">{</span>
      <span class="ow">|</span> <span class="nc">None</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="k">let</span> <span class="n">t</span> <span class="ow">=</span> <span class="ow">(</span><span class="n">nodes</span><span class="ow">,</span> <span class="n">state</span><span class="ow">.</span><span class="n">tree</span><span class="ow">);</span>
          <span class="k">switch</span> <span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">back</span><span class="ow">)</span> <span class="ow">{</span>
          <span class="ow">|</span> <span class="bp">[]</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="nc">TopoOrder</span><span class="ow">(</span><span class="n">state</span><span class="ow">.</span><span class="n">finished</span><span class="ow">),</span> <span class="n">t</span><span class="ow">)</span>
          <span class="ow">|</span> <span class="ow">[</span><span class="n">e</span><span class="ow">,</span> <span class="ow">..._]</span> <span class="ow">=&gt;</span> <span class="ow">(</span><span class="nc">Cycle</span><span class="ow">(</span><span class="n">e</span><span class="ow">),</span> <span class="n">t</span><span class="ow">)</span>
          <span class="ow">}</span>
        <span class="ow">}</span>
      <span class="ow">|</span> <span class="nc">Some</span><span class="ow">(</span><span class="n">node</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="nn">Stack</span><span class="p">.</span><span class="n">push</span><span class="ow">(</span><span class="nc">Visit</span><span class="ow">(</span><span class="n">node</span><span class="ow">),</span> <span class="n">stack</span><span class="ow">);</span>
          <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="n">state</span><span class="ow">)</span>
        <span class="ow">}</span>
      <span class="ow">}</span>
    <span class="ow">}</span> <span class="k">else</span> <span class="ow">{</span>
      <span class="k">switch</span> <span class="ow">(</span><span class="nn">Stack</span><span class="p">.</span><span class="n">pop</span><span class="ow">(</span><span class="n">stack</span><span class="ow">))</span> <span class="ow">{</span>
      <span class="ow">|</span> <span class="nc">Visit</span><span class="ow">(</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="nn">Stack</span><span class="p">.</span><span class="n">push</span><span class="ow">(</span><span class="nc">Finish</span><span class="ow">(</span><span class="n">n</span><span class="ow">),</span> <span class="n">stack</span><span class="ow">);</span>
          <span class="k">let</span> <span class="n">neighbors</span> <span class="ow">=</span> <span class="n">adjList</span><span class="ow">(</span><span class="n">n</span><span class="ow">);</span>
          <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="ow">(</span><span class="n">n2</span> <span class="ow">=&gt;</span> <span class="nn">Stack</span><span class="p">.</span><span class="n">push</span><span class="ow">(</span><span class="nc">Edge</span><span class="ow">(</span><span class="n">n</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">),</span> <span class="n">stack</span><span class="ow">),</span> <span class="n">neighbors</span><span class="ow">);</span>
          <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">visited</span><span class="ow">:</span> <span class="ow">[</span><span class="n">n</span><span class="ow">,</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">visited</span><span class="ow">]})</span>
        <span class="ow">}</span>
      <span class="ow">|</span> <span class="nc">Finish</span><span class="ow">(</span><span class="n">n</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">finished</span><span class="ow">:</span> <span class="ow">[</span><span class="n">n</span><span class="ow">,</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">finished</span><span class="ow">]})</span>
        <span class="ow">}</span>
      <span class="ow">|</span> <span class="nc">Edge</span><span class="ow">(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">)</span> <span class="ow">=&gt;</span> <span class="ow">{</span>
          <span class="k">if</span> <span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">n2</span><span class="ow">,</span> <span class="n">state</span><span class="ow">.</span><span class="n">finished</span><span class="ow">))</span> <span class="ow">{</span>
            <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">forward</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">),</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">forward</span><span class="ow">]})</span>
          <span class="ow">}</span> <span class="k">else</span> <span class="k">if</span> <span class="ow">(</span><span class="nn">List</span><span class="p">.</span><span class="n">mem</span><span class="ow">(</span><span class="n">n2</span><span class="ow">,</span> <span class="n">state</span><span class="ow">.</span><span class="n">visited</span><span class="ow">))</span> <span class="ow">{</span>
            <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">back</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">),</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">back</span><span class="ow">]})</span>
          <span class="ow">}</span> <span class="k">else</span> <span class="ow">{</span>
            <span class="nn">Stack</span><span class="p">.</span><span class="n">push</span><span class="ow">(</span><span class="nc">Visit</span><span class="ow">(</span><span class="n">n2</span><span class="ow">),</span> <span class="n">stack</span><span class="ow">);</span>
            <span class="n">run</span><span class="ow">(</span><span class="n">stack</span><span class="ow">,</span> <span class="ow">{...</span><span class="n">state</span><span class="ow">,</span> <span class="n">tree</span><span class="ow">:</span> <span class="ow">[(</span><span class="n">n1</span><span class="ow">,</span> <span class="n">n2</span><span class="ow">),</span> <span class="ow">...</span><span class="n">state</span><span class="ow">.</span><span class="n">tree</span><span class="ow">]})</span>
          <span class="ow">}</span>
        <span class="ow">}</span>
      <span class="ow">}</span>
    <span class="ow">}</span>
  <span class="ow">};</span>

  <span class="k">let</span> <span class="n">initialState</span> <span class="ow">=</span> <span class="ow">{</span>
    <span class="n">visited</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">finished</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">tree</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">forward</span><span class="ow">:</span> <span class="bp">[]</span><span class="ow">,</span>
    <span class="n">back</span><span class="ow">:</span> <span class="bp">[]</span>
  <span class="ow">};</span>

  <span class="n">run</span><span class="ow">(</span><span class="nn">Stack</span><span class="p">.</span><span class="n">create</span><span class="bp">()</span><span class="ow">,</span> <span class="n">initialState</span><span class="ow">)</span>
<span class="ow">};</span>

<span class="n">depthFirst2</span><span class="ow">(</span><span class="n">adjlist_of_pairs</span><span class="ow">(</span><span class="n">demo</span><span class="ow">));</span>
<span class="n">depthFirst2</span><span class="ow">(</span><span class="n">adjlist_of_pairs</span><span class="ow">(</span><span class="n">demo2</span><span class="ow">));</span>
</pre></div>
</div>
</div>
<div class="section" id="breath-first-traversal">
<h3>Breath-First Traversal<a class="headerlink" href="#breath-first-traversal" title="Permalink to this headline">¶</a></h3>
<p>The big payoff of rewriting the depth-first traversal to use an explicit stack is that we can now explain breadth-first traversal (and level order traversal of a tree) quite simply: instead of a stack, use a queue!
The idea is that the queue is maintaining a list of edges yet to be processed. When the algorithm starts, we push all of the edges of the initial node onto the queue and process them in order.
As we handle each edge, if its target node has not yet been visited, then we push all of its outgoing edges onto the queue, <em>but they will have to wait until all of the current edges are processed</em>.
In this way, we visit all of the immediate neighbors first, and then we continue with their neighbors, followed by their neighbors’ neighbors, <em>etc</em>., until the entire graph is traversed.</p>
<p>Breadth-first traversal is desirable when the graph might be large and we want to stop searching when we find the closest match, or if we only want to process items within a given distance (for example, it is used in game-playing strategies to look ahead up to a certain number of moves). Several famous algorithms can also be viewed as variants of breadth-first traversal.</p>
<div class="section" id="dijkstra-s-algorithm">
<h4>Dijkstra’s Algorithm<a class="headerlink" href="#dijkstra-s-algorithm" title="Permalink to this headline">¶</a></h4>
<p>Consider a labeled graph where each edge has an associated (non-negative) distance or cost.
Instead of using a queue to store the edges under consideration, we will use a <strong>priority queue</strong> (perhaps implemented as a binary heap). By assigning a priority based on the total length of the path from the starting node (including the edge under consideration), Dijkstra’s algorithm will greedily build a <strong>shortest-path tree</strong> with the starting node as the root. This is an effective way to answer questions like “what is the shortest travel time from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span>?” or “what is the closest node to <span class="math notranslate nohighlight">\(A\)</span> with a given property?”</p>
</div>
<div class="section" id="prim-s-algorithm">
<h4>Prim’s Algorithm<a class="headerlink" href="#prim-s-algorithm" title="Permalink to this headline">¶</a></h4>
<p>If we have an <em>undirected</em> graph and perform Dijkstra’s algorithm with the priority of an edge being just the cost of that edge alone, then instead of a shortest-path tree we get a <strong>minimum spanning tree</strong>.
This is the smallest subset of edges that connects all of the nodes, with the least possible total cost of the edges.</p>
<p>(TODO examples will have to wait until the tree rendering can do labels…)</p>
</div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Give the list of pairs, adjacency list, and adjacency matrix representations for the following <em>undirected</em> graph:</p></li>
</ol>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ex1</span> <span class="ow">=</span> <span class="ow">([</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">],</span> <span class="ow">[(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;C&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;B&quot;</span><span class="ow">,</span> <span class="s2">&quot;C&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;C&quot;</span><span class="ow">,</span> <span class="s2">&quot;B&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;A&quot;</span><span class="ow">,</span> <span class="s2">&quot;D&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;D&quot;</span><span class="ow">,</span> <span class="s2">&quot;A&quot;</span><span class="ow">)]);</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutGrid</span><span class="ow">(</span><span class="n">ex1</span><span class="ow">,</span> <span class="mi">2</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
<p>[[spoiler | Answer]]
| <code class="docutils literal notranslate"><span class="pre">reason</span> <span class="pre">hidden</span> <span class="pre">|</span> <span class="pre">print_string(&quot;Pairs\n&quot;);</span> <span class="pre">|</span> <span class="pre">showPairs(ex1,</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s);</span> <span class="pre">|</span> <span class="pre">print_string(&quot;Adjacency</span> <span class="pre">List:\n&quot;);</span> <span class="pre">|</span> <span class="pre">showAdjList(adjlist_of_pairs(ex1),</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s);</span> <span class="pre">|</span> <span class="pre">print_string(&quot;Adjacency</span> <span class="pre">Matrix:\n&quot;);</span> <span class="pre">|</span> <span class="pre">showAdjMatrix(adjmatrix_of_pairs(ex1),</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s);</span> <span class="pre">|</span> </code></p>
<ol class="simple">
<li><p>Consider the adjacency matrix representation of a graph. What can you say about the matrix if the graph is undirected? What if the graph has loops on all of the nodes?</p></li>
</ol>
<p>[[spoiler | Answer]]
| An undirected graph will have a <em>symmetric</em> adjacency matrix: the entry in row <span class="math notranslate nohighlight">\(i\)</span>, column <span class="math notranslate nohighlight">\(j\)</span> is the same as the entry in row <span class="math notranslate nohighlight">\(j\)</span>, column <span class="math notranslate nohighlight">\(i\)</span> (symmetric about the diagonal).
| A graph with all of the self-loops will have 1’s along the diagonal (and a simple graph, with no loops, will have 0’s on the diagonal).</p>
<ol class="simple">
<li><p>(Based on a problem from Aho &amp; Ullman) Consider the following directed graph:</p></li>
</ol>
<div class="highlight-reason notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">ex3</span> <span class="ow">=</span> <span class="ow">([</span><span class="s2">&quot;a&quot;</span><span class="ow">,</span> <span class="s2">&quot;b&quot;</span><span class="ow">,</span> <span class="s2">&quot;c&quot;</span><span class="ow">,</span> <span class="s2">&quot;d&quot;</span><span class="ow">,</span> <span class="s2">&quot;e&quot;</span><span class="ow">,</span> <span class="s2">&quot;f&quot;</span><span class="ow">],</span> <span class="ow">[(</span><span class="s2">&quot;a&quot;</span><span class="ow">,</span> <span class="s2">&quot;b&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;a&quot;</span><span class="ow">,</span> <span class="s2">&quot;d&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;b&quot;</span><span class="ow">,</span> <span class="s2">&quot;c&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;b&quot;</span><span class="ow">,</span> <span class="s2">&quot;f&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;c&quot;</span><span class="ow">,</span> <span class="s2">&quot;d&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;d&quot;</span><span class="ow">,</span> <span class="s2">&quot;e&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;e&quot;</span><span class="ow">,</span> <span class="s2">&quot;b&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;e&quot;</span><span class="ow">,</span> <span class="s2">&quot;f&quot;</span><span class="ow">),</span> <span class="ow">(</span><span class="s2">&quot;f&quot;</span><span class="ow">,</span> <span class="s2">&quot;a&quot;</span><span class="ow">)]);</span>
<span class="n">draw</span><span class="ow">(</span><span class="n">renderLayout</span><span class="ow">(</span><span class="n">layoutCircle</span><span class="ow">(</span><span class="n">ex3</span><span class="ow">,</span> <span class="mi">40</span><span class="ow">.),</span> <span class="n">s</span> <span class="ow">=&gt;</span> <span class="n">s</span><span class="ow">,</span> <span class="n">defaultStyleNode</span><span class="ow">,</span> <span class="n">defaultStyleEdge</span><span class="ow">));</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Give two different depth-first traversal trees starting at node <span class="math notranslate nohighlight">\(a\)</span>. For each, also label the graph to show the forward and back edges, and the finishing number.</p></li>
</ul>
<p>[[spoiler | Answer]]
| Using depth-first traversal (others are possible):
| <code class="docutils literal notranslate"><span class="pre">reason</span> <span class="pre">hidden</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">finishedNode</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">=&gt;</span> <span class="pre">img</span> <span class="pre">=&gt;</span> <span class="pre">fill(Color(&quot;white&quot;),</span> <span class="pre">|</span>&#160;&#160; <span class="pre">img</span> <span class="pre">+++</span> <span class="pre">translate(12.,</span> <span class="pre">6.,</span> <span class="pre">withFont(0.4,</span> <span class="pre">Serif,</span> <span class="pre">Regular,</span> <span class="pre">Normal,</span> <span class="pre">fill(color(&quot;black&quot;),</span> <span class="pre">text(string_of_int(n))))));</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">ns1</span> <span class="pre">=</span> <span class="pre">node</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(node)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;a&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(6)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;b&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(5)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;c&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(4)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;d&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(3)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;e&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(2)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;f&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(1)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleNode(node)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">es1</span> <span class="pre">=</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;c&quot;,</span> <span class="pre">&quot;d&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;d&quot;,</span> <span class="pre">&quot;e&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;e&quot;,</span> <span class="pre">&quot;f&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">treeEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;f&quot;,</span> <span class="pre">&quot;a&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;e&quot;,</span> <span class="pre">&quot;b&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">backEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;f&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;d&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">forwardEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleEdge(n1,</span> <span class="pre">n2)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">draw(renderLayout(layoutCircle(ex3,</span> <span class="pre">40.),</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s,</span> <span class="pre">ns1,</span> <span class="pre">es1));</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">ns2</span> <span class="pre">=</span> <span class="pre">node</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(node)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;a&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(6)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;b&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(3)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;c&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(1)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;d&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(5)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;e&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(4)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;f&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(2)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleNode(node)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">es2</span> <span class="pre">=</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;d&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;d&quot;,</span> <span class="pre">&quot;e&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;e&quot;,</span> <span class="pre">&quot;b&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;f&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">treeEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;c&quot;,</span> <span class="pre">&quot;d&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;f&quot;,</span> <span class="pre">&quot;a&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">backEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;e&quot;,</span> <span class="pre">&quot;f&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">forwardEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleEdge(n1,</span> <span class="pre">n2)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">draw(renderLayout(layoutCircle(ex3,</span> <span class="pre">40.),</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s,</span> <span class="pre">ns2,</span> <span class="pre">es2));</span> <span class="pre">|</span> </code></p>
<ul class="simple">
<li><p>Find the distance (length of the shortest path) from <span class="math notranslate nohighlight">\(a\)</span> to each of the other nodes.</p></li>
</ul>
<p>[[spoiler | Answer]]
| Using breadth-first traversal:
| <code class="docutils literal notranslate"><span class="pre">reason</span> <span class="pre">hidden</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">ns3</span> <span class="pre">=</span> <span class="pre">node</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(node)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;a&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(0)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;b&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(1)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;c&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(2)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;d&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(1)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;e&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(2)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">&quot;f&quot;</span> <span class="pre">=&gt;</span> <span class="pre">finishedNode(2)</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleNode(node)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">let</span> <span class="pre">es3</span> <span class="pre">=</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">=&gt;</span> <span class="pre">switch</span> <span class="pre">(n1,</span> <span class="pre">n2)</span> <span class="pre">{</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;d&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;b&quot;,</span> <span class="pre">&quot;f&quot;)</span> <span class="pre">|</span> <span class="pre">(&quot;d&quot;,</span> <span class="pre">&quot;e&quot;)</span> <span class="pre">=&gt;</span> <span class="pre">treeEdge</span> <span class="pre">|</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">=&gt;</span> <span class="pre">defaultStyleEdge(n1,</span> <span class="pre">n2)</span> <span class="pre">|</span> <span class="pre">};</span> <span class="pre">|</span> <span class="pre">draw(renderLayout(layoutCircle(ex3,</span> <span class="pre">40.),</span> <span class="pre">s</span> <span class="pre">=&gt;</span> <span class="pre">s,</span> <span class="pre">ns3,</span> <span class="pre">es3));</span> <span class="pre">|</span> </code></p>
<ol class="simple">
<li><p>What would go wrong in Dijkstra’s algorithm if we allowed edges with a negative cost? Give an example where it fails to find the shortest path.</p></li>
</ol>
<p>[[spoiler | Answer]]
| With negative cost edges the greedy approach to building the shortest-path tree is not guaranteed to find the shortest paths.
| Suppose there is an edge from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span> with cost 2, and an edge from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(C\)</span> with cost 3: Dijkstra’s algorithm will say that the shortest path from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span> has cost 2, without even looking at node <span class="math notranslate nohighlight">\(C\)</span>.
| However, if there is an edge from <span class="math notranslate nohighlight">\(C\)</span> to <span class="math notranslate nohighlight">\(B\)</span> with cost <span class="math notranslate nohighlight">\(-2\)</span>, then the better route would be to go <span class="math notranslate nohighlight">\(A\rightarrow C\rightarrow B\)</span>, with total cost 1.
|
| Even worse, if there were a cycle in the graph with a total negative cost (such as <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(B\)</span> with cost 1, but <span class="math notranslate nohighlight">\(B\)</span> to <span class="math notranslate nohighlight">\(A\)</span> with cost <span class="math notranslate nohighlight">\(-2\)</span>), then any path touching that cycle could be extended to follow the cycle any number of times, leading to an arbitrarily low (large negative) cost! For such a graph, the notion of “shortest path” is undefined.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ds"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="bst.html" title="previous page">Binary Search Trees and Heaps</a>
    <a class='right-next' id="next-link" href="../lang/index.html" title="next page">Formal Languages</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brian T. Howard, based in part on material by Carol Critchlow and David Eck<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>