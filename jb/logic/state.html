

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>State Machines &#8212; FoCSipedia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sets" href="../sets/index.html" />
    <link rel="prev" title="Sequential Circuits" href="sequential.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/SmartFoxLogo.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">FoCSipedia</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution.html">
   Attribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../topics.html">
   Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview of Topics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="index.html">
   Logic
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro.html">
     Logic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="props.html">
     Propositional Logic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="boolean.html">
     Boolean Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="circuits.html">
     Logic Circuits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="simplify.html">
     Circuit Simplification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="components.html">
     Common Circuit Components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="preds.html">
     Predicates and Quantifiers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="deduction.html">
     Deduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pred-deduction.html">
     Natural Deduction for Predicate Logic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="induction.html">
     Mathematical Induction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="recursion.html">
     Recursion and Induction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sequential.html">
     Sequential Circuits
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     State Machines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sets/index.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fp/index.html">
   Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ds/index.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lang/index.html">
   Formal Languages
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/logic/state.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="state-machines">
<h1>State Machines<a class="headerlink" href="#state-machines" title="Permalink to this headline">¶</a></h1>
<p>In another section[^Not yet written….] we learned about Moore machines, a version of finite state automata where there is an output associated with each state.
Using flip-flops, we can build a circuit that implements a Moore machine.
Here is a block diagram for such a circuit (although the connections are shown as single wires, all but the clock may be several bits wide):</p>
<p>&lt;img src={useBaseUrl(‘img/MooreMachine.png’)}
alt=”Moore Machine” className=”centered-figure” /&gt;</p>
<p>In addition to the feedback within each flip-flop, there is a larger-scale feedback loop of the current state back to provide input for the next step. The box labelled <em>Comb. Logic</em> is a combinational circuit with two functions: compute an output based on the current state, and compute the next-state control signals based on the input and the current state. The box labelled <em>State</em> is one or more flip-flops; when a clock pulse arrives, it takes the control signals from the combinational logic and advances to the next state—the <strong>state</strong> of the machine is simply the current states of these flip-flops.</p>
<p>If there are <span class="math notranslate nohighlight">\(k\)</span> flip-flops, each of which can be 0 or 1, then the machine can be in <span class="math notranslate nohighlight">\(2^k\)</span> different states.
Therefore, if our Moore machine needs <span class="math notranslate nohighlight">\(n\)</span> states, we will need at least <span class="math notranslate nohighlight">\(\lceil\lg n\rceil\)</span> flip-flops.
One step in designing the circuit for a given machine will be to assign a binary encoding to each state.
For example, if the machine has three states, <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span>, then we will need two flip-flops.
The circuit state will be the combination of the flip-flop outputs: <span class="math notranslate nohighlight">\(Q_1Q_0\)</span>.
Given this, we may arbitrarily choose the encoding <span class="math notranslate nohighlight">\(A=00\)</span>, <span class="math notranslate nohighlight">\(B=01\)</span>, and <span class="math notranslate nohighlight">\(C=10\)</span> (and the state <span class="math notranslate nohighlight">\(11\)</span> will go unused).</p>
<p>Although the diagram shows the combinational logic has both the machine input and the current state available to compute the output, the convention in a Moore machine is that only the state is used to determine the output.
There is a practical reason for this: during a clock cycle, as soon as the current state has propagated through the logic gates, we want the output to be available and stable.
The input signals may not be stable until close to the end of the cycle (just before they are needed to determine the next state), and we would prefer not to see “glitches” in the output while the input might still be changing.</p>
<p>Here is an example of this process.
Consider the following state machine for a mod-3 up/down counter:</p>
<p>&lt;img src={useBaseUrl(‘img/Mod3CounterMachine.png’)}
alt=”Mod-3 Counter Machine” className=”centered-figure” /&gt;</p>
<p>It has one input, which will be read once per clock pulse; call it <span class="math notranslate nohighlight">\(a\)</span>.
When <span class="math notranslate nohighlight">\(a\)</span> is 0, each clock pulse increments the counter through the states <span class="math notranslate nohighlight">\(q_0\)</span>, <span class="math notranslate nohighlight">\(q_1\)</span>, <span class="math notranslate nohighlight">\(q_2\)</span>, and back to <span class="math notranslate nohighlight">\(q_0\)</span>.
When <span class="math notranslate nohighlight">\(a\)</span> is 1, it decrements.
At each state, the output is the corresponding number in binary: 00, 01, and 10.</p>
<p>We will use two D flip-flops, and the obvious encoding of states to bit patterns (which also happens to be the mapping from state to output, so we can just use the current state, 00, 01, or 10, to drive the output directly).All that remains is to design the combinational circuit that computes the <span class="math notranslate nohighlight">\(D_1\)</span> and <span class="math notranslate nohighlight">\(D_0\)</span> flip-flop control signals based on the input and current state.
For this, we will first fill in a truth table with current state, input, and desired next state values, then use the excitation table for the flip-flops to decide an appropriate signal (for type-D flip-flops, this is particularly easy, since the required <span class="math notranslate nohighlight">\(D\)</span> input is just the next state <span class="math notranslate nohighlight">\(Q'\)</span>):</p>
<p>+—————+—————-+—————–+—————+
| current       | input          | next            | control       |
+——-+——-+—————-+——–+——–+——-+——-+
| <span class="math notranslate nohighlight">\(Q_1\)</span> | <span class="math notranslate nohighlight">\(Q_2\)</span> | <span class="math notranslate nohighlight">\(a\)</span>            | <span class="math notranslate nohighlight">\(Q_1'\)</span> | <span class="math notranslate nohighlight">\(Q_0'\)</span> | <span class="math notranslate nohighlight">\(D_1\)</span> | <span class="math notranslate nohighlight">\(D_0\)</span> |
+=======+=======+================+========+========+=======+=======+
| 0     | 0     | 0              | 0      | 1      | 0     | 1     |
+——-+——-+—————-+——–+——–+——-+——-+
| 0     | 0     | 1              | 1      | 0      | 1     | 0     |
+——-+——-+—————-+——–+——–+——-+——-+
| 0     | 1     | 0              | 1      | 0      | 1     | 0     |
+——-+——-+—————-+——–+——–+——-+——-+
| 0     | 1     | 1              | 0      | 0      | 0     | 0     |
+——-+——-+—————-+——–+——–+——-+——-+
| 1     | 0     | 0              | 0      | 0      | 0     | 0     |
+——-+——-+—————-+——–+——–+——-+——-+
| 1     | 0     | 1              | 0      | 1      | 0     | 1     |
+——-+——-+—————-+——–+——–+——-+——-+</p>
<p>Here is the Karnaugh map for <span class="math notranslate nohighlight">\(D_1\)</span>:</p>
<p>&lt;img src={useBaseUrl(‘img/KarnaughMod3D1.png’)}
alt=”Mod-3 Counter, D1 Karnaugh Map” className=”centered-figure” /&gt;</p>
<p>And here is the map for <span class="math notranslate nohighlight">\(D_0\)</span>:</p>
<p>&lt;img src={useBaseUrl(‘img/KarnaughMod3D0.png’)}
alt=”Mod-3 Counter, D0 Karnaugh Map” className=”centered-figure” /&gt;</p>
<p>Therefore, simple DNF expressions for the control signals are <span class="math notranslate nohighlight">\(D_1=\overline{Q}_1\overline{Q}_0a+Q_0\overline{a}\)</span> and <span class="math notranslate nohighlight">\(D_0=\overline{Q}_1\overline{Q}_0\overline{a}+Q_1a\)</span>.
The full circuit for the counter is therefore:</p>
<p>&lt;img src={useBaseUrl(‘img/Mod3Counter.png’)}
alt=”Mod-3 Counter Circuit” className=”centered-figure” /&gt;</p>
<blockquote>
<div><p>With combinational circuits to perform arithmetic and logic operations on data, plus registers to store intermediate results and keep track of program steps, a sequential circuit allows us to model an entire central processing unit.
By connecting the inputs and outputs to external storage and I/O devices, the CPU forms the core of a general-purpose computer; details are left to the reader.</p>
</div></blockquote>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Design a BCD accumulator whose input is a three-bit two’s complement number representing the value to be added to the total. That is, the state will be a decimal digit 0–9, represented in binary (0000 through 1001). The output should be the signal lines to drive a seven-segment display (see Exercise 4 of the <a class="reference external" href="simplify.md#exercises">Circuit Simplification</a> section). If the input is 000, then the state will be unchanged. If the input is +1 (001) through +3 (011), then that number will be added on each clock pulse. If the input is -4 (100) through -1 (111), then the total will go down by that amount on each pulse.</p></li>
<li><p>Reinterpret the block diagram for a Moore machine to produce a Mealy machine, where an output is associated with each transition.
That is, the output should be determined by the current state <em>and</em> the input.
What might happen to the output if the input changes during a clock cycle?
Compare this behavior to a Moore machine.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./logic"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="sequential.html" title="previous page">Sequential Circuits</a>
    <a class='right-next' id="next-link" href="../sets/index.html" title="next page">Sets</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brian T. Howard, based in part on material by Carol Critchlow and David Eck<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>