

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Scala Doodle &#8212; FoCSipedia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spring 2020 DPoodle Gallery, Section A" href="galleryS20A.html" />
    <link rel="prev" title="DPoodle Graphics Drawing Project" href="doodle-project.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/SmartFoxLogo.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">FoCSipedia</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution.html">
   Attribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../topics.html">
   Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview of Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../logic/index.html">
   Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sets/index.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="index.html">
   Functional Programming
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro.html">
     Introduction to Functional Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="types.html">
     Types in Functional Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="map-reduce.html">
     Map and Reduce on Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="doodle.html">
     DPoodle Graphics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="doodle-project.html">
     DPoodle Graphics Drawing Project
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Scala Doodle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="galleryS20A.html">
     Spring 2020 DPoodle Gallery, Section A
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="galleryS20B.html">
     Spring 2020 DPoodle Gallery, Section B
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="state.html">
     State Machines in Java and ReasonML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parser-comb.html">
     Recursive Descent and Parser Combinators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lambda.html">
     Lambda Calculus
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ds/index.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lang/index.html">
   Formal Languages
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/fp/scaladoodle.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="scala-doodle">
<h1>Scala Doodle<a class="headerlink" href="#scala-doodle" title="Permalink to this headline">Â¶</a></h1>
<p>This is the code for the DePauw Scala version of the Doodle library (as used on <a class="reference external" href="https://scalafiddle.io/sf/gDzN6Mw/37">scalafiddle.io</a>):</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">fiddle.Fiddle</span><span class="o">,</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">println</span>
<span class="k">import</span> <span class="nn">scalajs.js</span>

<span class="nd">@js</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="nc">JSExportTopLevel</span><span class="o">(</span><span class="s">&quot;ScalaFiddle&quot;</span><span class="o">)</span>
<span class="k">object</span> <span class="nc">ScalaFiddle</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">org.scalajs.dom.CanvasRenderingContext2D</span>
  
  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">left</span><span class="k">:</span> <span class="kt">Double</span>
    <span class="k">def</span> <span class="n">right</span><span class="k">:</span> <span class="kt">Double</span>
    <span class="k">def</span> <span class="n">top</span><span class="k">:</span> <span class="kt">Double</span>
    <span class="k">def</span> <span class="n">bottom</span><span class="k">:</span> <span class="kt">Double</span>
    <span class="k">def</span> <span class="n">width</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span>
    <span class="k">def</span> <span class="n">height</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span>
    <span class="k">def</span> <span class="n">draw</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">10</span><span class="o">-</span><span class="n">left</span><span class="o">,</span> <span class="mi">10</span><span class="o">-</span><span class="n">top</span><span class="o">).</span><span class="n">lineColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">black</span><span class="o">).</span><span class="n">fillColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">transparent</span><span class="o">).</span><span class="n">render</span>
    
    <span class="k">def</span> <span class="n">beside</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Beside</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">that</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">above</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Above</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">that</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">below</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Above</span><span class="o">(</span><span class="n">that</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">on</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Layer</span><span class="o">(</span><span class="n">that</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">under</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Layer</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">that</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">fillColor</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Pattern</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">FillColor</span><span class="o">(</span><span class="n">c</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">lineColor</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Pattern</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">LineColor</span><span class="o">(</span><span class="n">c</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">lineWidth</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">LineWidth</span><span class="o">(</span><span class="n">w</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">color</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Pattern</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">FillColor</span><span class="o">(</span><span class="n">c</span><span class="o">)),</span> <span class="nc">LineColor</span><span class="o">(</span><span class="n">c</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">font</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">Font</span><span class="o">(</span><span class="n">value</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">dashed</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Styled</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="nc">Dashed</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">bounds</span><span class="o">(</span><span class="n">left</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">right</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">top</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">bottom</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Bounds</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">top</span><span class="o">,</span> <span class="n">bottom</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">resize</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">h</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Bounds</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">recenter</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="o">)/</span><span class="mi">2</span><span class="o">,</span> <span class="o">-(</span><span class="n">top</span> <span class="o">+</span> <span class="n">bottom</span><span class="o">)/</span><span class="mi">2</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">showBounds</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="k">this</span> <span class="n">under</span> <span class="o">(</span>
      <span class="nc">Rectangle</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">).</span><span class="n">translate</span><span class="o">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="n">top</span> <span class="o">+</span> <span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="o">)</span> <span class="n">under</span>
      <span class="nc">Circle</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="n">under</span>
      <span class="nc">Path</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="nc">MoveTo</span><span class="o">(</span><span class="nc">Point</span><span class="o">(-</span><span class="mi">20</span><span class="o">,</span> <span class="mi">0</span><span class="o">)),</span> <span class="nc">LineTo</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">0</span><span class="o">))),</span> <span class="kc">false</span><span class="o">)</span> <span class="n">under</span>
      <span class="nc">Path</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="nc">MoveTo</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="o">-</span><span class="mi">20</span><span class="o">)),</span> <span class="nc">LineTo</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">))),</span> <span class="kc">false</span><span class="o">)</span>
    <span class="o">).</span><span class="n">lineColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">black</span><span class="o">).</span><span class="n">dashed</span><span class="o">.</span><span class="n">resize</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">translate</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">at</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">at</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">at</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">v</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">rotate</span><span class="o">(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Rotate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">angle</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">scale</span><span class="o">(</span><span class="n">factor</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Scale</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">factor</span><span class="o">,</span> <span class="n">factor</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">scale</span><span class="o">(</span><span class="n">xfactor</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">yfactor</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Scale</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">xfactor</span><span class="o">,</span> <span class="n">yfactor</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">byTopLeft</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">left</span><span class="o">,</span> <span class="o">-</span><span class="n">top</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byBottomLeft</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">left</span><span class="o">,</span> <span class="o">-</span><span class="n">bottom</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byTopRight</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">right</span><span class="o">,</span> <span class="o">-</span><span class="n">top</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byBottomRight</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">right</span><span class="o">,</span> <span class="o">-</span><span class="n">bottom</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byTop</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">-</span><span class="n">top</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byBottom</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">-</span><span class="n">bottom</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byLeft</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">left</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">byRight</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Translate</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="o">-</span><span class="n">right</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">topLeft</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">top</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">bottomLeft</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">bottom</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">topRight</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">top</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">bottomRight</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">bottom</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">circle</span><span class="o">(</span><span class="n">radius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Circle</span><span class="o">(</span><span class="n">radius</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">rectangle</span><span class="o">(</span><span class="n">width</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">height</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">triangle</span><span class="o">(</span><span class="n">width</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">height</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Triangle</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">ellipse</span><span class="o">(</span><span class="n">width</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">height</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Ellipse</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">openPath</span><span class="o">(</span><span class="n">path</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">])</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Path</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">closedPath</span><span class="o">(</span><span class="n">path</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">])</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Path</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">text</span><span class="o">(</span><span class="n">string</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Text</span><span class="o">(</span><span class="n">string</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">empty</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">import</span> <span class="nn">Image._</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">h</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="o">-</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fillRect</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">top</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">strokeRect</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">top</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Triangle</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">h</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="o">-</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">beginPath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">moveTo</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">bottom</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">lineTo</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">top</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">lineTo</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">bottom</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">closePath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fill</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">stroke</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Circle</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">r</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="o">-</span><span class="n">r</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">r</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">beginPath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">arc</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="nc">Pi</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">closePath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fill</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">stroke</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Ellipse</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">h</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="o">-</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">scale</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">h</span> <span class="o">/</span> <span class="n">w</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">beginPath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">arc</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="nc">Pi</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">closePath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fill</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">stroke</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Path</span><span class="o">(</span><span class="n">path</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">],</span> <span class="n">closed</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">points</span> <span class="k">=</span> <span class="n">path</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">p</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="n">points</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">x</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">ys</span> <span class="k">=</span> <span class="n">points</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">min</span> <span class="n">min</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">max</span> <span class="n">max</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">min</span> <span class="n">min</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">max</span> <span class="n">max</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">beginPath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">moveTo</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">path</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">trace</span><span class="o">(</span><span class="n">d</span><span class="o">))</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">closed</span><span class="o">)</span> <span class="n">d</span><span class="o">.</span><span class="n">closePath</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fill</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">stroke</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Text</span><span class="o">(</span><span class="n">string</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">textAlign</span> <span class="k">=</span> <span class="s">&quot;center&quot;</span>
      <span class="n">d</span><span class="o">.</span><span class="n">textBaseline</span> <span class="k">=</span> <span class="s">&quot;middle&quot;</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fillText</span><span class="o">(</span><span class="n">string</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">d</span><span class="o">.</span><span class="n">strokeText</span><span class="o">(</span><span class="n">string</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Beside</span><span class="o">(</span><span class="n">l</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">r</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">val</span> <span class="n">width</span> <span class="k">=</span> <span class="n">l</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">width</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">l</span><span class="o">.</span><span class="n">top</span> <span class="n">min</span> <span class="n">r</span><span class="o">.</span><span class="n">top</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">l</span><span class="o">.</span><span class="n">bottom</span> <span class="n">max</span> <span class="n">r</span><span class="o">.</span><span class="n">bottom</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="o">(</span><span class="n">left</span> <span class="o">-</span> <span class="n">l</span><span class="o">.</span><span class="n">left</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">l</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">r</span><span class="o">.</span><span class="n">left</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">r</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Above</span><span class="o">(</span><span class="n">t</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Image</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">val</span> <span class="n">height</span> <span class="k">=</span> <span class="n">t</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">height</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">t</span><span class="o">.</span><span class="n">left</span> <span class="n">min</span> <span class="n">b</span><span class="o">.</span><span class="n">left</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">t</span><span class="o">.</span><span class="n">right</span> <span class="n">max</span> <span class="n">b</span><span class="o">.</span><span class="n">right</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="o">-</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">height</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">top</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">top</span><span class="o">)</span>
      <span class="n">t</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">t</span><span class="o">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">top</span><span class="o">)</span>
      <span class="n">b</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Layer</span><span class="o">(</span><span class="n">layers</span><span class="k">:</span> <span class="kt">Image*</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">left</span><span class="o">).</span><span class="n">min</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">right</span><span class="o">).</span><span class="n">max</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">top</span><span class="o">).</span><span class="n">min</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">bottom</span><span class="o">).</span><span class="n">max</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="k">for</span> <span class="o">(</span><span class="n">layer</span> <span class="k">&lt;-</span> <span class="n">layers</span><span class="o">)</span> <span class="n">layer</span><span class="o">.</span><span class="n">render</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Styled</span><span class="o">(</span><span class="n">image</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">style</span><span class="k">:</span> <span class="kt">Style</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">left</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">right</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">top</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">bottom</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">style</span><span class="o">(</span><span class="n">d</span><span class="o">)</span>
      <span class="n">image</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Translate</span><span class="o">(</span><span class="n">image</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">left</span> <span class="o">+</span> <span class="n">x</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">right</span> <span class="o">+</span> <span class="n">x</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">top</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">bottom</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
      <span class="n">image</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Rotate</span><span class="o">(</span><span class="n">image</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">points</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="n">topLeft</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="n">topRight</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="n">bottomLeft</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="n">bottomRight</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">rotate</span><span class="o">(</span><span class="n">angle</span><span class="o">))</span>
    <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="n">points</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">x</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">ys</span> <span class="k">=</span> <span class="n">points</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">min</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">max</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">min</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">max</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">rotate</span><span class="o">(</span><span class="n">angle</span><span class="o">.</span><span class="n">toRadians</span><span class="o">)</span>
      <span class="n">image</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Scale</span><span class="o">(</span><span class="n">image</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">xfactor</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">yfactor</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">left</span> <span class="o">*</span> <span class="n">xfactor</span> <span class="n">min</span> <span class="n">image</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">xfactor</span>
    <span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">left</span> <span class="o">*</span> <span class="n">xfactor</span> <span class="n">max</span> <span class="n">image</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">xfactor</span>
    <span class="k">val</span> <span class="n">top</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">top</span> <span class="o">*</span> <span class="n">yfactor</span> <span class="n">min</span> <span class="n">image</span><span class="o">.</span><span class="n">bottom</span> <span class="o">*</span> <span class="n">yfactor</span>
    <span class="k">val</span> <span class="n">bottom</span> <span class="k">=</span> <span class="n">image</span><span class="o">.</span><span class="n">top</span> <span class="o">*</span> <span class="n">yfactor</span> <span class="n">max</span> <span class="n">image</span><span class="o">.</span><span class="n">bottom</span> <span class="o">*</span> <span class="n">yfactor</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="o">()</span>
      <span class="n">d</span><span class="o">.</span><span class="n">scale</span><span class="o">(</span><span class="n">xfactor</span><span class="o">,</span> <span class="n">yfactor</span><span class="o">)</span>
      <span class="n">image</span><span class="o">.</span><span class="n">render</span>
      <span class="n">d</span><span class="o">.</span><span class="n">restore</span><span class="o">()</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Bounds</span><span class="o">(</span><span class="n">image</span><span class="k">:</span> <span class="kt">Image</span><span class="o">,</span> <span class="n">left</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">right</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">top</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">bottom</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">render</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">render</span>
  <span class="o">}</span>
  
  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">LineWidth</span><span class="o">(</span><span class="n">w</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="n">d</span><span class="o">.</span><span class="n">lineWidth</span> <span class="k">=</span> <span class="n">w</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">LineColor</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Pattern</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="n">d</span><span class="o">.</span><span class="n">strokeStyle</span> <span class="k">=</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">FillColor</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">Pattern</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="n">d</span><span class="o">.</span><span class="n">fillStyle</span> <span class="k">=</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">object</span> <span class="nc">Dashed</span> <span class="k">extends</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="n">d</span><span class="o">.</span><span class="n">setLineDash</span><span class="o">(</span><span class="n">scala</span><span class="o">.</span><span class="n">scalajs</span><span class="o">.</span><span class="n">js</span><span class="o">.</span><span class="nc">Array</span><span class="o">(</span><span class="mf">4.0</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Font</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Style</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
      <span class="n">d</span><span class="o">.</span><span class="n">font</span> <span class="k">=</span> <span class="n">value</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Pattern</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">value</span><span class="k">:</span> <span class="kt">js.Any</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">LinearGradient</span><span class="o">(</span><span class="n">start</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">end</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">stops</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[(</span><span class="kt">Normalized</span><span class="p">,</span> <span class="kt">Color</span><span class="o">)])</span> <span class="k">extends</span> <span class="nc">Pattern</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">value</span><span class="k">:</span> <span class="kt">js.Any</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="k">val</span> <span class="n">gradient</span> <span class="k">=</span> <span class="n">d</span><span class="o">.</span><span class="n">createLinearGradient</span><span class="o">(</span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">end</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
      <span class="k">for</span> <span class="o">((</span><span class="n">pos</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="n">stops</span><span class="o">)</span> <span class="n">gradient</span><span class="o">.</span><span class="n">addColorStop</span><span class="o">(</span><span class="n">pos</span><span class="o">.</span><span class="n">value</span><span class="o">,</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
      <span class="n">gradient</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">RadialGradient</span><span class="o">(</span><span class="n">start</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">startRadius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">end</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">endRadius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">stops</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[(</span><span class="kt">Normalized</span><span class="p">,</span> <span class="kt">Color</span><span class="o">)])</span> <span class="k">extends</span> <span class="nc">Pattern</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">value</span><span class="k">:</span> <span class="kt">js.Any</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Fiddle</span><span class="o">.</span><span class="n">draw</span>
      <span class="k">val</span> <span class="n">gradient</span> <span class="k">=</span> <span class="n">d</span><span class="o">.</span><span class="n">createRadialGradient</span><span class="o">(</span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">startRadius</span><span class="o">,</span>
        <span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">end</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">endRadius</span><span class="o">)</span>
      <span class="k">for</span> <span class="o">((</span><span class="n">pos</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span> <span class="k">&lt;-</span> <span class="n">stops</span><span class="o">)</span> <span class="n">gradient</span><span class="o">.</span><span class="n">addColorStop</span><span class="o">(</span><span class="n">pos</span><span class="o">.</span><span class="n">value</span><span class="o">,</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
      <span class="n">gradient</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Pattern</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">linearGradient</span><span class="o">(</span><span class="n">start</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">end</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">stops</span><span class="k">:</span> <span class="o">(</span><span class="kt">Normalized</span><span class="o">,</span> <span class="kt">Color</span><span class="o">)*)</span><span class="k">:</span> <span class="kt">Pattern</span> <span class="o">=</span>
      <span class="nc">LinearGradient</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">stops</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">radialGradient</span><span class="o">(</span><span class="n">start</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">startRadius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span>
        <span class="n">end</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">endRadius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">stops</span><span class="k">:</span> <span class="o">(</span><span class="kt">Normalized</span><span class="o">,</span> <span class="kt">Color</span><span class="o">)*)</span> <span class="k">=</span>
      <span class="nc">RadialGradient</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">startRadius</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">endRadius</span><span class="o">,</span> <span class="n">stops</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">dichromaticVertical</span><span class="o">(</span><span class="n">color1</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">color2</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">length</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Pattern</span> <span class="o">=</span>
      <span class="n">linearGradient</span><span class="o">(</span><span class="nc">Point</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">length</span><span class="o">),</span> <span class="o">(</span><span class="mf">0.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color1</span><span class="o">),</span> <span class="o">(</span><span class="mf">1.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color2</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">dichromaticHorizontal</span><span class="o">(</span><span class="n">color1</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">color2</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">length</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Pattern</span> <span class="o">=</span>
      <span class="n">linearGradient</span><span class="o">(</span><span class="nc">Point</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span> <span class="nc">Point</span><span class="o">(</span><span class="n">length</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span> <span class="o">(</span><span class="mf">0.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color1</span><span class="o">),</span> <span class="o">(</span><span class="mf">1.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color2</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">dichromaticRadial</span><span class="o">(</span><span class="n">color1</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">color2</span><span class="k">:</span> <span class="kt">Color</span><span class="o">,</span> <span class="n">radius</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Pattern</span> <span class="o">=</span>
      <span class="n">radialGradient</span><span class="o">(</span><span class="nc">Point</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="nc">Point</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span> <span class="n">radius</span><span class="o">,</span> <span class="o">(</span><span class="mf">0.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color1</span><span class="o">),</span> <span class="o">(</span><span class="mf">1.</span><span class="n">normalized</span><span class="o">,</span> <span class="n">color2</span><span class="o">))</span>
  <span class="o">}</span>
  
  <span class="k">import</span> <span class="nn">Pattern._</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">green</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">blue</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">alpha</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">.</span><span class="n">normalized</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Pattern</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">value</span><span class="k">:</span> <span class="kt">js.Any</span> <span class="o">=</span> <span class="s">s&quot;rgba(</span><span class="si">$red</span><span class="s">, </span><span class="si">$green</span><span class="s">, </span><span class="si">$blue</span><span class="s">, </span><span class="si">$alpha</span><span class="s">)&quot;</span>
    
    <span class="k">def</span> <span class="n">hue</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="n">hsl</span><span class="o">.</span><span class="n">_1</span>
    <span class="k">def</span> <span class="n">saturation</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="n">hsl</span><span class="o">.</span><span class="n">_2</span>
    <span class="k">def</span> <span class="n">lightness</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="n">hsl</span><span class="o">.</span><span class="n">_3</span>
    
    <span class="k">def</span> <span class="n">hsl</span><span class="k">:</span> <span class="o">(</span><span class="kt">Angle</span><span class="o">,</span> <span class="kt">Normalized</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">r</span> <span class="k">=</span> <span class="n">red</span><span class="o">.</span><span class="n">toNormalized</span><span class="o">.</span><span class="n">value</span>
      <span class="k">val</span> <span class="n">g</span> <span class="k">=</span> <span class="n">green</span><span class="o">.</span><span class="n">toNormalized</span><span class="o">.</span><span class="n">value</span>
      <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="n">blue</span><span class="o">.</span><span class="n">toNormalized</span><span class="o">.</span><span class="n">value</span>
      <span class="k">val</span> <span class="n">cMax</span> <span class="k">=</span> <span class="n">r</span> <span class="n">max</span> <span class="n">g</span> <span class="n">max</span> <span class="n">b</span>
      <span class="k">val</span> <span class="n">cMin</span> <span class="k">=</span> <span class="n">r</span> <span class="n">min</span> <span class="n">g</span> <span class="n">min</span> <span class="n">b</span>
      <span class="k">val</span> <span class="n">delta</span> <span class="k">=</span> <span class="n">cMax</span> <span class="o">-</span> <span class="n">cMin</span>
  
      <span class="k">val</span> <span class="n">unnormalizedHue</span> <span class="k">=</span>
        <span class="k">if</span><span class="o">(</span><span class="n">cMax</span> <span class="o">==</span> <span class="n">r</span><span class="o">)</span>
          <span class="mi">60</span> <span class="o">*</span> <span class="o">(((</span><span class="n">g</span> <span class="o">-</span> <span class="n">b</span><span class="o">)</span> <span class="o">/</span> <span class="n">delta</span><span class="o">))</span>
        <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cMax</span> <span class="o">==</span> <span class="n">g</span><span class="o">)</span>
          <span class="mi">60</span> <span class="o">*</span> <span class="o">(((</span><span class="n">b</span> <span class="o">-</span> <span class="n">r</span><span class="o">)</span> <span class="o">/</span> <span class="n">delta</span><span class="o">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">)</span>
        <span class="k">else</span>
          <span class="mi">60</span> <span class="o">*</span> <span class="o">(((</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="o">)</span> <span class="o">/</span> <span class="n">delta</span><span class="o">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">)</span>
      <span class="k">val</span> <span class="n">hue</span> <span class="k">=</span> <span class="n">unnormalizedHue</span><span class="o">.</span><span class="n">degrees</span>
  
      <span class="k">val</span> <span class="n">lightness</span> <span class="k">=</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">((</span><span class="n">cMax</span> <span class="o">+</span> <span class="n">cMin</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span>
  
      <span class="k">val</span> <span class="n">saturation</span> <span class="k">=</span>
        <span class="k">if</span><span class="o">(</span><span class="n">delta</span> <span class="o">==</span> <span class="mf">0.0</span><span class="o">)</span>
          <span class="mf">0.</span><span class="n">normalized</span>
        <span class="k">else</span>
          <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">delta</span> <span class="o">/</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">abs</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lightness</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)))</span>
  
      <span class="o">(</span><span class="n">hue</span><span class="o">,</span> <span class="n">saturation</span><span class="o">,</span> <span class="n">lightness</span><span class="o">)</span>
    <span class="o">}</span>
    
    <span class="k">def</span> <span class="n">hue</span><span class="o">(</span><span class="n">h</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">saturation</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">lightness</span><span class="o">(</span><span class="n">l</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">alpha</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span>
      <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
  
    <span class="k">def</span> <span class="n">spin</span><span class="o">(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">angle</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">lighten</span><span class="o">(</span><span class="n">lightness</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">lightness</span><span class="o">.</span><span class="n">value</span><span class="o">),</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">darken</span><span class="o">(</span><span class="n">darkness</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">darkness</span><span class="o">.</span><span class="n">value</span><span class="o">),</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">saturate</span><span class="o">(</span><span class="n">saturation</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">saturation</span><span class="o">.</span><span class="n">value</span><span class="o">),</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">desaturate</span><span class="o">(</span><span class="n">desaturation</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">desaturation</span><span class="o">.</span><span class="n">value</span><span class="o">),</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">fadeIn</span><span class="o">(</span><span class="n">opacity</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">opacity</span><span class="o">.</span><span class="n">value</span><span class="o">))</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">fadeOut</span><span class="o">(</span><span class="n">opacity</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">opacity</span><span class="o">.</span><span class="n">value</span><span class="o">))</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">lightenBy</span><span class="o">(</span><span class="n">lightness</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">lightness</span><span class="o">.</span><span class="n">value</span><span class="o">)),</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">darkenBy</span><span class="o">(</span><span class="n">darkness</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">darkness</span><span class="o">.</span><span class="n">value</span><span class="o">)),</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">saturateBy</span><span class="o">(</span><span class="n">saturation</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">saturation</span><span class="o">.</span><span class="n">value</span><span class="o">)),</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">desaturateBy</span><span class="o">(</span><span class="n">desaturation</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">)</span> <span class="k">=</span> <span class="n">hsl</span>
      <span class="nc">Color</span><span class="o">.</span><span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">desaturation</span><span class="o">.</span><span class="n">value</span><span class="o">)),</span> <span class="n">l</span><span class="o">,</span> <span class="n">alpha</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">fadeInBy</span><span class="o">(</span><span class="n">opacity</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">opacity</span><span class="o">.</span><span class="n">value</span><span class="o">)))</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">fadeOutBy</span><span class="o">(</span><span class="n">opacity</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
      <span class="nc">Color</span><span class="o">(</span><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">opacity</span><span class="o">.</span><span class="n">value</span><span class="o">)))</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Color</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">rgb</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">g</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="nc">Color</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">rgba</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">g</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">UByte</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="nc">Color</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">hsl</span><span class="o">(</span><span class="n">h</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">,</span> <span class="n">s</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="mf">1.</span><span class="n">normalized</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">hsla</span><span class="o">(</span><span class="n">h</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">,</span> <span class="n">s</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Color</span> <span class="o">=</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mf">0.0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">val</span> <span class="n">lightness</span> <span class="k">=</span> <span class="n">l</span><span class="o">.</span><span class="n">toUnsignedByte</span>
            <span class="n">rgba</span><span class="o">(</span><span class="n">lightness</span><span class="o">,</span> <span class="n">lightness</span><span class="o">,</span> <span class="n">lightness</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
          <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">def</span> <span class="n">hueToRgb</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">q</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">t</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span>
              <span class="nc">Normalized</span><span class="o">.</span><span class="n">wrap</span><span class="o">(</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="o">)</span> <span class="n">p</span> <span class="o">+</span> <span class="o">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">p</span><span class="o">)</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span>
                <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="o">)</span> <span class="n">q</span>
                <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span><span class="o">)</span> <span class="n">p</span> <span class="o">+</span> <span class="o">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">p</span><span class="o">)</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">*</span> <span class="o">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">)</span>
                <span class="k">else</span> <span class="n">p</span><span class="o">)</span>
  
            <span class="k">val</span> <span class="n">lightness</span> <span class="k">=</span> <span class="n">l</span><span class="o">.</span><span class="n">value</span>
            <span class="k">val</span> <span class="n">saturation</span> <span class="k">=</span> <span class="n">s</span><span class="o">.</span><span class="n">value</span>
            <span class="k">val</span> <span class="n">q</span> <span class="k">=</span>
              <span class="k">if</span> <span class="o">(</span><span class="n">lightness</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="o">)</span> <span class="n">lightness</span> <span class="o">*</span> <span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">saturation</span><span class="o">)</span>
              <span class="k">else</span> <span class="n">lightness</span> <span class="o">+</span> <span class="n">saturation</span> <span class="o">-</span> <span class="n">lightness</span> <span class="o">*</span> <span class="n">saturation</span>
            <span class="k">val</span> <span class="n">p</span> <span class="k">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lightness</span> <span class="o">-</span> <span class="n">q</span>
            <span class="k">val</span> <span class="n">r</span> <span class="k">=</span> <span class="n">hueToRgb</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">wrap</span><span class="o">((</span><span class="n">h</span> <span class="o">+</span> <span class="mf">120.d</span><span class="n">egrees</span><span class="o">).</span><span class="n">toTurns</span><span class="o">))</span>
            <span class="k">val</span> <span class="n">g</span> <span class="k">=</span> <span class="n">hueToRgb</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">wrap</span><span class="o">(</span><span class="n">h</span><span class="o">.</span><span class="n">toTurns</span><span class="o">))</span>
            <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="n">hueToRgb</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">,</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">wrap</span><span class="o">((</span><span class="n">h</span> <span class="o">-</span> <span class="mf">120.d</span><span class="n">egrees</span><span class="o">).</span><span class="n">toTurns</span><span class="o">))</span>
  
            <span class="n">rgba</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="n">toUnsignedByte</span><span class="o">,</span> <span class="n">g</span><span class="o">.</span><span class="n">toUnsignedByte</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="n">toUnsignedByte</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
          <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="k">val</span> <span class="n">transparent</span>          <span class="k">=</span> <span class="n">rgba</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mf">0.</span><span class="n">normalized</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">aliceBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">antiqueWhite</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xeb</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd7</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">aqua</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">aquamarine</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x7f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd4</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">azure</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">beige</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">bisque</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc4</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">black</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">blanchedAlmond</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xeb</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">blue</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">blueViolet</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x8a</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe2</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">brown</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xa5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2a</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2a</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">burlyWood</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xde</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x87</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">cadetBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x5f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x9e</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">chartreuse</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x7f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">chocolate</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd2</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x1e</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">coral</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x7f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x50</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">cornflowerBlue</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x64</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x95</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xed</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">cornSilk</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">crimson</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x14</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x3c</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">cyan</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkBlue</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkCyan</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkGoldenrod</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xb8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x86</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x0b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkGray</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkGrey</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa9</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkGreen</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x64</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkKhaki</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xbd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb7</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x6b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkMagenta</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkOliveGreen</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x55</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x6b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkOrange</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8c</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkOrchid</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x99</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x32</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcc</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkRed</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkSalmon</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xe9</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x96</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x7a</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkSeaGreen</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x8f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xbc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkSlateBlue</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x48</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x3d</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkSlateGray</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x2f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x4f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x4f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkSlateGrey</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x2f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x4f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x4f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkTurquoise</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xce</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd1</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">darkViolet</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x94</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">deepPink</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x14</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x93</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">deepSkyBlue</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xbf</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">dimGray</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">dimGrey</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">dodgerBlue</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x1e</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x90</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">fireBrick</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xb2</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x22</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x22</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">floralWhite</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">forestGreen</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x22</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x22</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">fuchsia</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">gainsboro</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xdc</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">ghostWhite</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">gold</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd7</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">goldenrod</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xda</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x20</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">gray</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">grey</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">green</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">greenYellow</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xad</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">honeydew</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">hotpink</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb4</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">indianRed</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x5c</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x5c</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">indigo</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x4b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x82</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">ivory</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">khaki</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8c</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lavender</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lavenderBlush</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lawngreen</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x7c</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lemonChiffon</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xad</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightCoral</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightCyan</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xe0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightGoldenrodYellow</span> <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd2</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightGray</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightGrey</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightGreen</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x90</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x90</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightPink</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb6</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc1</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSalmon</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x7a</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSeaGreen</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x20</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb2</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xaa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSkyBlue</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x87</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xce</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSlateGray</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x77</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x88</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x99</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSlateGrey</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x77</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x88</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x99</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightSteelBlue</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xb0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xde</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lightYellow</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">lime</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">limeGreen</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x32</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x32</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">linen</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">magenta</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">maroon</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumAquamarine</span>     <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x66</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xaa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumBlue</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumOrchid</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xba</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x55</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd3</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumPurple</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x93</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd8</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumSeaGreen</span>       <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x3c</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb3</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x71</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumSlateBlue</span>      <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x7b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x68</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumSpringGreen</span>    <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x9a</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumTurquoise</span>      <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x48</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd1</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcc</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mediumVioletRed</span>      <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xc7</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x15</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x85</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">midnightBlue</span>         <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x19</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x19</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mintCream</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">mistyRose</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe1</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">moccasin</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb5</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">navajoWhite</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xde</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xad</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">navy</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">oldLace</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xfd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">olive</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">oliveDrab</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x6b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8e</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x23</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">orange</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">orangeRed</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x45</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">orchid</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xda</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd6</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">paleGoldenrod</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xaa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">paleGreen</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x98</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfb</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x98</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">paleTurquoise</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xaf</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">paleVioletRed</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x93</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">papayaWhip</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xef</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd5</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">peachPuff</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xda</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb9</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">peru</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x85</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x3f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">pink</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcb</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">plum</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xdd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xdd</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">powderBlue</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xb0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe6</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">purple</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">rebeccaPurple</span>        <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x66</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x33</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x99</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">red</span>                  <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">rosyBrown</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xbc</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8f</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">royalBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x41</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x69</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe1</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">saddleBrown</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x45</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x13</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">salmon</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x72</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">sandyBrown</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xa4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x60</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">seaGreen</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x2e</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8b</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x57</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">seaShell</span>             <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">sienna</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xa0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x52</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x2d</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">silver</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xc0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xc0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">skyBlue</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x87</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xce</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xeb</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">slateBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x6a</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x5a</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">slateGray</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x90</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">slateGrey</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x70</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x90</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">snow</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xfa</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">springGreen</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x7f</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">steelBlue</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x46</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x82</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb4</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">tan</span>                  <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd2</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb4</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x8c</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">teal</span>                 <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x80</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">thistle</span>              <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xd8</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xbf</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd8</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">tomato</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x63</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x47</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">turquoise</span>            <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x40</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xe0</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xd0</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">violet</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x82</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xee</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">wheat</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xde</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xb3</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">white</span>                <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">whiteSmoke</span>           <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xf5</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">yellow</span>               <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xff</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">yellowGreen</span>          <span class="k">=</span> <span class="n">rgb</span><span class="o">(</span><span class="mh">0x9a</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0xcd</span><span class="o">.</span><span class="n">uByte</span><span class="o">,</span> <span class="mh">0x33</span><span class="o">.</span><span class="n">uByte</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">class</span> <span class="nc">UByte</span><span class="o">(</span><span class="k">val</span> <span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">toString</span>
    <span class="k">def</span> <span class="n">toNormalized</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">value</span> <span class="o">/</span> <span class="mf">255.0</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">UByte</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">clip</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">UByte</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UByte</span><span class="o">(</span><span class="n">n</span> <span class="n">max</span> <span class="mi">0</span> <span class="n">min</span> <span class="mi">255</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">IntUByteOps</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">uByte</span><span class="k">:</span> <span class="kt">UByte</span> <span class="o">=</span> <span class="nc">UByte</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">n</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">class</span> <span class="nc">Normalized</span><span class="o">(</span><span class="k">val</span> <span class="n">value</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">toString</span>
    <span class="k">def</span> <span class="n">toUnsignedByte</span><span class="k">:</span> <span class="kt">UByte</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">round</span><span class="o">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">255</span><span class="o">).</span><span class="n">toInt</span><span class="o">.</span><span class="n">uByte</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Normalized</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">clip</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Normalized</span><span class="o">(</span><span class="n">x</span> <span class="n">max</span> <span class="mf">0.0</span> <span class="n">min</span> <span class="mf">1.0</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">wrap</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Normalized</span><span class="o">(</span><span class="k">if</span> <span class="o">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="n">x</span> <span class="k">else</span> <span class="n">x</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
  <span class="o">}</span>
  
  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">DoubleNormalizedOps</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">normalized</span><span class="k">:</span> <span class="kt">Normalized</span> <span class="o">=</span> <span class="nc">Normalized</span><span class="o">.</span><span class="n">clip</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">class</span> <span class="nc">Angle</span><span class="o">(</span><span class="k">val</span> <span class="n">toRadians</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="o">+(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">toRadians</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">toRadians</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">-(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">toRadians</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">toRadians</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">*(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">toRadians</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">/(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">toRadians</span> <span class="o">/</span> <span class="n">x</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">unary_-</span> <span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(-</span><span class="n">toRadians</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">toDegrees</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">toRadians</span> <span class="o">/</span> <span class="nc">Angle</span><span class="o">.</span><span class="nc">TwoPi</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="k">def</span> <span class="n">toTurns</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">toRadians</span> <span class="o">/</span> <span class="nc">Angle</span><span class="o">.</span><span class="nc">TwoPi</span>
    <span class="k">def</span> <span class="n">cos</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="o">(</span><span class="n">toRadians</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">sin</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="o">(</span><span class="n">toRadians</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Angle</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nc">TwoPi</span> <span class="k">=</span> <span class="n">math</span><span class="o">.</span><span class="nc">Pi</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">val</span> <span class="n">zero</span> <span class="k">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="mf">0.0</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">one</span> <span class="k">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="nc">TwoPi</span><span class="o">)</span>
  
    <span class="k">def</span> <span class="n">degrees</span><span class="o">(</span><span class="n">deg</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">deg</span> <span class="o">*</span> <span class="nc">TwoPi</span> <span class="o">/</span> <span class="mf">360.0</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">radians</span><span class="o">(</span><span class="n">rad</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">rad</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">turns</span><span class="o">(</span><span class="n">t</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">t</span> <span class="o">*</span> <span class="nc">TwoPi</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">radians</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Angle</span><span class="o">(</span><span class="n">radians</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">DoubleAngleOps</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">radians</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">radians</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">degrees</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">degrees</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">turns</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">turns</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">*(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">*</span> <span class="n">x</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="o">+(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">-(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">unary_-</span> <span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(-</span><span class="n">x</span><span class="o">,</span> <span class="o">-</span><span class="n">y</span><span class="o">)</span>

    <span class="k">def</span> <span class="o">*(</span><span class="n">d</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">d</span><span class="o">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">d</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">/(</span><span class="n">d</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">d</span><span class="o">,</span> <span class="n">y</span> <span class="o">/</span> <span class="n">d</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">radians</span><span class="o">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">length</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">)</span>

    <span class="k">def</span> <span class="n">normalize</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">len</span> <span class="k">=</span> <span class="n">length</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="nc">Vec</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="k">else</span> <span class="k">this</span> <span class="o">/</span> <span class="n">len</span>
    <span class="o">}</span>

    <span class="k">def</span> <span class="n">rotate</span><span class="o">(</span><span class="n">by</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">.</span><span class="n">polar</span><span class="o">(</span><span class="n">length</span><span class="o">,</span> <span class="n">angle</span> <span class="o">+</span> <span class="n">by</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">dot</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span>
    <span class="k">def</span> <span class="n">cross</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span>
    <span class="k">def</span> <span class="n">toPoint</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Vec</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">zero</span> <span class="k">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">unitX</span> <span class="k">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">unitY</span> <span class="k">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">polar</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">cos</span><span class="o">,</span> <span class="n">r</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">sin</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">polar</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="n">polar</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">implicit</span> <span class="k">class</span> <span class="nc">DoubleVecOps</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="o">*(</span><span class="n">vec</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="n">vec</span> <span class="o">*</span> <span class="n">x</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">def</span> <span class="o">+(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="o">-(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>

    <span class="k">def</span> <span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span> <span class="o">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">radians</span><span class="o">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">))</span>
    <span class="k">def</span> <span class="n">length</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">toVec</span><span class="k">:</span> <span class="kt">Vec</span> <span class="o">=</span> <span class="nc">Vec</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>

    <span class="k">def</span> <span class="n">rotate</span><span class="o">(</span><span class="n">by</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">.</span><span class="n">polar</span><span class="o">(</span><span class="n">length</span><span class="o">,</span> <span class="n">angle</span> <span class="o">+</span> <span class="n">by</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Point</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">zero</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">cartesian</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">polar</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">cos</span><span class="o">,</span> <span class="n">r</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">sin</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">import</span> <span class="nn">Point._</span>

  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">PathElement</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Point</span>
    <span class="k">def</span> <span class="n">trace</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">PathElement</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">moveTo</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span><span class="k">:</span> <span class="kt">PathElement</span> <span class="o">=</span> <span class="nc">MoveTo</span><span class="o">(</span><span class="n">p</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">lineTo</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span><span class="k">:</span> <span class="kt">PathElement</span> <span class="o">=</span> <span class="nc">LineTo</span><span class="o">(</span><span class="n">p</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">curveTo</span><span class="o">(</span><span class="n">c1</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">c2</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span><span class="k">:</span> <span class="kt">PathElement</span> <span class="o">=</span> <span class="nc">CurveTo</span><span class="o">(</span><span class="n">c1</span><span class="o">,</span> <span class="n">c2</span><span class="o">,</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">import</span> <span class="nn">PathElement._</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">MoveTo</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">PathElement</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">trace</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">moveTo</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">LineTo</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">PathElement</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">trace</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">lineTo</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">CurveTo</span><span class="o">(</span><span class="n">c1</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">c2</span><span class="k">:</span> <span class="kt">Point</span><span class="o">,</span> <span class="n">p</span><span class="k">:</span> <span class="kt">Point</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">PathElement</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">trace</span><span class="o">(</span><span class="n">d</span><span class="k">:</span> <span class="kt">CanvasRenderingContext2D</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">bezierCurveTo</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">object</span> <span class="nc">Turtle</span> <span class="o">{</span>
    <span class="k">case</span> <span class="k">class</span> <span class="nc">TurtleState</span><span class="o">(</span><span class="n">at</span><span class="k">:</span> <span class="kt">Vec</span><span class="o">,</span> <span class="n">heading</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span>
    
    <span class="k">def</span> <span class="n">draw</span><span class="o">(</span><span class="n">instructions</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Instruction</span><span class="o">])</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">iterate</span><span class="o">(</span><span class="n">state</span><span class="k">:</span> <span class="kt">TurtleState</span><span class="o">,</span> <span class="n">instructions</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Instruction</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">]</span> <span class="k">=</span>
        <span class="n">instructions</span> <span class="k">match</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span>
            <span class="nc">Nil</span>
          <span class="k">case</span> <span class="n">i</span> <span class="o">::</span> <span class="n">is</span> <span class="k">=&gt;</span>
            <span class="k">val</span> <span class="o">(</span><span class="n">newState</span><span class="o">,</span> <span class="n">elements</span><span class="o">)</span> <span class="k">=</span> <span class="n">process</span><span class="o">(</span><span class="n">state</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span>
            <span class="n">elements</span> <span class="o">++</span> <span class="n">iterate</span><span class="o">(</span><span class="n">newState</span><span class="o">,</span> <span class="n">is</span><span class="o">)</span>
        <span class="o">}</span>
        
      <span class="k">def</span> <span class="n">process</span><span class="o">(</span><span class="n">state</span><span class="k">:</span> <span class="kt">TurtleState</span><span class="o">,</span> <span class="n">instruction</span><span class="k">:</span> <span class="kt">Instruction</span><span class="o">)</span><span class="k">:</span> <span class="o">(</span><span class="kt">TurtleState</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>
        <span class="k">import</span> <span class="nn">PathElement._</span>
      
        <span class="n">instruction</span> <span class="k">match</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nc">Forward</span><span class="o">(</span><span class="n">d</span><span class="o">)</span> <span class="k">=&gt;</span>
            <span class="k">val</span> <span class="n">nowAt</span> <span class="k">=</span> <span class="n">state</span><span class="o">.</span><span class="n">at</span> <span class="o">+</span> <span class="nc">Vec</span><span class="o">.</span><span class="n">polar</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">state</span><span class="o">.</span><span class="n">heading</span><span class="o">)</span>
            <span class="k">val</span> <span class="n">element</span> <span class="k">=</span> <span class="n">lineTo</span><span class="o">(</span><span class="n">nowAt</span><span class="o">.</span><span class="n">toPoint</span><span class="o">)</span>
            <span class="o">(</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">at</span> <span class="k">=</span> <span class="n">nowAt</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="n">element</span><span class="o">))</span>
          <span class="k">case</span> <span class="nc">Turn</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="k">=&gt;</span>
            <span class="k">val</span> <span class="n">nowHeading</span> <span class="k">=</span> <span class="n">state</span><span class="o">.</span><span class="n">heading</span> <span class="o">+</span> <span class="n">a</span>
            <span class="o">(</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">heading</span> <span class="k">=</span> <span class="n">nowHeading</span><span class="o">),</span> <span class="nc">List</span><span class="o">())</span>
          <span class="k">case</span> <span class="nc">Branch</span><span class="o">(</span><span class="n">is</span><span class="o">)</span> <span class="k">=&gt;</span>
            <span class="k">val</span> <span class="n">branchedElements</span> <span class="k">=</span> <span class="n">iterate</span><span class="o">(</span><span class="n">state</span><span class="o">,</span> <span class="n">is</span><span class="o">)</span>
            <span class="o">(</span><span class="n">state</span><span class="o">,</span> <span class="n">branchedElements</span> <span class="o">:+</span> <span class="n">moveTo</span><span class="o">(</span><span class="n">state</span><span class="o">.</span><span class="n">at</span><span class="o">.</span><span class="n">toPoint</span><span class="o">))</span>
          <span class="k">case</span> <span class="nc">NoOp</span> <span class="k">=&gt;</span>
            <span class="o">(</span><span class="n">state</span><span class="o">,</span> <span class="nc">List</span><span class="o">())</span>
        <span class="o">}</span>
      <span class="o">}</span>
    
      <span class="n">openPath</span><span class="o">(</span><span class="n">iterate</span><span class="o">(</span><span class="nc">TurtleState</span><span class="o">(</span><span class="nc">Vec</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">zero</span><span class="o">),</span> <span class="n">instructions</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Instruction</span>
  
  <span class="k">object</span> <span class="nc">Instruction</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">forward</span><span class="o">(</span><span class="n">distance</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Instruction</span> <span class="o">=</span> <span class="nc">Forward</span><span class="o">(</span><span class="n">distance</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">turn</span><span class="o">(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Instruction</span> <span class="o">=</span> <span class="nc">Turn</span><span class="o">(</span><span class="n">angle</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">branch</span><span class="o">(</span><span class="n">instructions</span><span class="k">:</span> <span class="kt">Instruction*</span><span class="o">)</span><span class="k">:</span> <span class="kt">Instruction</span> <span class="o">=</span> <span class="nc">Branch</span><span class="o">(</span><span class="n">instructions</span><span class="o">.</span><span class="n">toList</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">noop</span><span class="k">:</span> <span class="kt">Instruction</span> <span class="o">=</span> <span class="nc">NoOp</span>
  <span class="o">}</span>
  
  <span class="k">import</span> <span class="nn">Instruction._</span>

  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Forward</span><span class="o">(</span><span class="n">distance</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Instruction</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Turn</span><span class="o">(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Instruction</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Branch</span><span class="o">(</span><span class="n">instructions</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Instruction</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">Instruction</span>
  
  <span class="k">final</span> <span class="k">case</span> <span class="k">object</span> <span class="nc">NoOp</span> <span class="k">extends</span> <span class="nc">Instruction</span>
  
  <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span> <span class="n">self</span> <span class="k">=&gt;</span>
    <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">T</span>
  
    <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="n">U</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">U</span> <span class="o">=</span> <span class="n">f</span><span class="o">(</span><span class="n">self</span><span class="o">.</span><span class="n">run</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">U</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=&gt;</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">U</span><span class="o">])</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">U</span> <span class="o">=</span> <span class="n">f</span><span class="o">(</span><span class="n">self</span><span class="o">.</span><span class="n">run</span><span class="o">).</span><span class="n">run</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">object</span> <span class="nc">Random</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">rng</span> <span class="k">=</span> <span class="k">new</span> <span class="n">scala</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="nc">Random</span>
  
    <span class="k">def</span> <span class="n">always</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">value</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="n">value</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">double</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">nextDouble</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">int</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">nextInt</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">natural</span><span class="o">(</span><span class="n">limit</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">nextInt</span><span class="o">(</span><span class="n">limit</span><span class="o">)</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">oneOf</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">values</span><span class="k">:</span> <span class="kt">T*</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="n">values</span><span class="o">(</span><span class="n">rng</span><span class="o">.</span><span class="n">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="n">size</span><span class="o">))</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">normal</span><span class="o">(</span><span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">stdDev</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">run</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">stdDev</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">nextGaussian</span>
    <span class="o">}</span>
  
    <span class="k">def</span> <span class="n">normal</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span> <span class="n">normal</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">implicit</span> <span class="k">def</span> <span class="n">drawRandomImage</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Image</span><span class="o">])</span> <span class="k">=</span> <span class="k">new</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">draw</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">draw</span>
  <span class="o">}</span>
  
  <span class="c1">// $FiddleStart</span>
  <span class="k">def</span> <span class="n">polygon</span><span class="o">(</span><span class="n">sides</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">size</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">initialRotation</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">iter</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">rotation</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">PathElement</span><span class="o">]</span> <span class="k">=</span> <span class="n">n</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="mi">0</span> <span class="k">=&gt;</span>
        <span class="nc">Nil</span>
      <span class="k">case</span> <span class="n">n</span> <span class="k">=&gt;</span>
        <span class="nc">LineTo</span><span class="o">(</span><span class="n">polar</span><span class="o">(</span><span class="n">size</span><span class="o">,</span> <span class="n">rotation</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">initialRotation</span><span class="o">))</span> <span class="o">::</span> <span class="n">iter</span><span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">rotation</span><span class="o">)</span>
    <span class="o">}</span>
    
    <span class="n">closedPath</span><span class="o">(</span><span class="n">moveTo</span><span class="o">(</span><span class="n">polar</span><span class="o">(</span><span class="n">size</span><span class="o">,</span> <span class="n">initialRotation</span><span class="o">))</span> <span class="o">::</span> <span class="n">iter</span><span class="o">(</span><span class="n">sides</span><span class="o">,</span> <span class="mf">360.d</span><span class="n">egrees</span> <span class="o">/</span> <span class="n">sides</span><span class="o">))</span>
  <span class="o">}</span>
  
  <span class="k">val</span> <span class="n">gradient</span> <span class="k">=</span> <span class="n">linearGradient</span><span class="o">(</span><span class="nc">Point</span><span class="o">(-</span><span class="mi">80</span><span class="o">,</span> <span class="o">-</span><span class="mi">80</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">80</span><span class="o">,</span> <span class="mi">80</span><span class="o">),</span>
    <span class="o">(</span><span class="mf">0.</span><span class="n">normalized</span><span class="o">,</span> <span class="nc">Color</span><span class="o">.</span><span class="n">red</span><span class="o">),</span>
    <span class="o">(</span><span class="mf">0.5</span><span class="o">.</span><span class="n">normalized</span><span class="o">,</span> <span class="nc">Color</span><span class="o">.</span><span class="n">green</span><span class="o">),</span>
    <span class="o">(</span><span class="mf">1.</span><span class="n">normalized</span><span class="o">,</span> <span class="nc">Color</span><span class="o">.</span><span class="n">blue</span><span class="o">))</span>
  
  <span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">polygon</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="mi">80</span><span class="o">,</span> <span class="mf">20.d</span><span class="n">egrees</span><span class="o">).</span><span class="n">fillColor</span><span class="o">(</span><span class="n">gradient</span><span class="o">).</span><span class="n">lineWidth</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">squareSpiral</span><span class="o">(</span><span class="n">steps</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">distance</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">,</span> <span class="n">increment</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nc">Turtle</span><span class="o">.</span><span class="n">draw</span><span class="o">((</span><span class="mi">1</span> <span class="n">to</span> <span class="n">steps</span><span class="o">).</span><span class="n">toList</span><span class="o">.</span><span class="n">flatMap</span> <span class="o">{</span> <span class="n">n</span> <span class="k">=&gt;</span>
      <span class="nc">List</span><span class="o">(</span><span class="n">forward</span><span class="o">(</span><span class="n">distance</span> <span class="o">+</span> <span class="o">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">increment</span><span class="o">)),</span> <span class="n">turn</span><span class="o">(</span><span class="n">angle</span><span class="o">))</span>
    <span class="o">})</span>
  <span class="o">}</span>
  
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="n">squareSpiral</span><span class="o">(</span><span class="mi">180</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mf">91.d</span><span class="n">egrees</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="n">recenter</span><span class="o">.</span><span class="n">lineColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">maroon</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">randomCircle</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">color</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Color</span><span class="o">])</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Image</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">color</span> <span class="n">map</span> <span class="o">(</span><span class="n">fill</span> <span class="k">=&gt;</span> <span class="nc">Image</span><span class="o">.</span><span class="n">circle</span><span class="o">(</span><span class="n">r</span><span class="o">)</span> <span class="n">fillColor</span> <span class="n">fill</span><span class="o">)</span>
    
  <span class="k">def</span> <span class="n">randomAngle</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Angle</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Random</span><span class="o">.</span><span class="n">double</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">turns</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">randomColor</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">,</span> <span class="n">l</span><span class="k">:</span> <span class="kt">Normalized</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Color</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">randomAngle</span> <span class="n">map</span> <span class="o">(</span><span class="n">hue</span> <span class="k">=&gt;</span> <span class="nc">Color</span><span class="o">.</span><span class="n">hsl</span><span class="o">(</span><span class="n">hue</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">l</span><span class="o">))</span>
  
  <span class="k">val</span> <span class="n">randomPastel</span> <span class="k">=</span> <span class="n">randomColor</span><span class="o">(</span><span class="mf">0.7</span><span class="o">.</span><span class="n">normalized</span><span class="o">,</span> <span class="mf">0.7</span><span class="o">.</span><span class="n">normalized</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">randomConcentricCircles</span><span class="o">(</span><span class="n">count</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">size</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Random</span><span class="o">[</span><span class="kt">Image</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">count</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="mi">0</span> <span class="k">=&gt;</span> <span class="nc">Random</span><span class="o">.</span><span class="n">always</span><span class="o">(</span><span class="nc">Image</span><span class="o">.</span><span class="n">empty</span><span class="o">)</span>
      <span class="k">case</span> <span class="n">n</span> <span class="k">=&gt;</span>
        <span class="k">for</span> <span class="o">{</span>
          <span class="n">circle</span> <span class="k">&lt;-</span> <span class="n">randomCircle</span><span class="o">(</span><span class="n">size</span><span class="o">,</span> <span class="n">randomPastel</span><span class="o">)</span>
          <span class="n">circles</span> <span class="k">&lt;-</span> <span class="n">randomConcentricCircles</span><span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">5</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">yield</span> <span class="n">circle</span> <span class="n">on</span> <span class="n">circles</span>
    <span class="o">}</span>
  
  <span class="k">val</span> <span class="n">rc</span> <span class="k">=</span> <span class="n">randomConcentricCircles</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="mi">50</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">parametricCircle</span><span class="o">(</span><span class="n">angle</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">)</span><span class="k">:</span> <span class="kt">Point</span> <span class="o">=</span> <span class="nc">Point</span><span class="o">.</span><span class="n">polar</span><span class="o">(</span><span class="mi">80</span><span class="o">,</span> <span class="n">angle</span><span class="o">)</span>
  
  <span class="k">def</span> <span class="n">sample</span><span class="o">(</span><span class="n">start</span><span class="k">:</span> <span class="kt">Angle</span><span class="o">,</span> <span class="n">samples</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// Angle.one is one complete turn. I.e. 360 degrees</span>
    <span class="k">val</span> <span class="n">step</span> <span class="k">=</span> <span class="nc">Angle</span><span class="o">.</span><span class="n">one</span> <span class="o">/</span> <span class="n">samples</span>
    <span class="k">val</span> <span class="n">dot</span> <span class="k">=</span> <span class="n">triangle</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">loop</span><span class="o">(</span><span class="n">count</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Image</span> <span class="o">=</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">angle</span> <span class="k">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">count</span>
      <span class="n">count</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="mi">0</span> <span class="k">=&gt;</span> <span class="nc">Image</span><span class="o">.</span><span class="n">empty</span>
        <span class="k">case</span> <span class="n">n</span> <span class="k">=&gt;</span> <span class="n">dot</span><span class="o">.</span><span class="n">at</span><span class="o">(</span><span class="n">parametricCircle</span><span class="o">(</span><span class="n">angle</span><span class="o">).</span><span class="n">toVec</span><span class="o">).</span><span class="n">color</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">fireBrick</span><span class="o">.</span><span class="n">spin</span><span class="o">(</span><span class="n">angle</span><span class="o">))</span> <span class="n">on</span> <span class="n">loop</span><span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>
        
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">loop</span><span class="o">(</span><span class="n">samples</span><span class="o">)</span>
  <span class="o">}</span>
  
  <span class="k">val</span> <span class="n">radGrad</span> <span class="k">=</span> <span class="n">dichromaticRadial</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="n">white</span><span class="o">,</span> <span class="nc">Color</span><span class="o">.</span><span class="n">purple</span><span class="o">,</span> <span class="mi">60</span><span class="o">)</span>
  
  <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="n">text</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">).</span><span class="n">font</span><span class="o">(</span><span class="s">&quot;20px serif&quot;</span><span class="o">).</span><span class="n">fillColor</span><span class="o">(</span><span class="n">radGrad</span><span class="o">).</span><span class="n">rotate</span><span class="o">(</span><span class="mf">45.d</span><span class="n">egrees</span><span class="o">)</span> <span class="n">on</span>
    <span class="n">sample</span><span class="o">(</span><span class="mf">0.d</span><span class="n">egrees</span><span class="o">,</span> <span class="mi">72</span><span class="o">)</span>
  
  <span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
    <span class="n">c</span> <span class="k">&lt;-</span> <span class="n">rc</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="o">((</span><span class="n">a</span> <span class="n">beside</span> <span class="o">(</span><span class="n">b</span> <span class="n">on</span> <span class="n">a</span><span class="o">.</span><span class="n">scale</span><span class="o">(</span><span class="mf">0.5</span><span class="o">).</span><span class="n">byLeft</span><span class="o">.</span><span class="n">showBounds</span><span class="o">.</span><span class="n">resize</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)))</span> <span class="n">above</span> <span class="o">(</span><span class="n">c</span> <span class="n">beside</span> <span class="n">d</span><span class="o">))</span>
  
  <span class="n">result</span><span class="o">.</span><span class="n">draw</span>
  <span class="c1">// $FiddleEnd</span>
<span class="o">}</span>
</pre></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./fp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="doodle-project.html" title="previous page">DPoodle Graphics Drawing Project</a>
    <a class='right-next' id="next-link" href="galleryS20A.html" title="next page">Spring 2020 DPoodle Gallery, Section A</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brian T. Howard, based in part on material by Carol Critchlow and David Eck<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>