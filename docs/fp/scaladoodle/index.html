<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="alternate" type="application/rss+xml" href="/focsipedia/blog/rss.xml" title="FoCSipedia Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/focsipedia/blog/atom.xml" title="FoCSipedia Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="FoCSipedia" href="/focsipedia/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">
<script src="/focsipedia/toplevel.js"></script>
<script src="/focsipedia/resetLocalPrelude.js"></script><title data-react-helmet="true">Scala Doodle | FoCSipedia</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Scala Doodle | FoCSipedia"><meta data-react-helmet="true" name="description" content="This is the code for the DePauw Scala version of the Doodle library (as used on scalafiddle.io):"><meta data-react-helmet="true" property="og:description" content="This is the code for the DePauw Scala version of the Doodle library (as used on scalafiddle.io):"><meta data-react-helmet="true" property="og:url" content="https://bhoward.github.io//focsipedia/docs/fp/scaladoodle"><link data-react-helmet="true" rel="shortcut icon" href="/focsipedia/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://bhoward.github.io//focsipedia/docs/fp/scaladoodle"><link rel="stylesheet" href="/focsipedia/styles.717a1e83.css">
<link rel="preload" href="/focsipedia/styles.2d63a02a.js" as="script">
<link rel="preload" href="/focsipedia/runtime~main.d68d7b50.js" as="script">
<link rel="preload" href="/focsipedia/main.3508471e.js" as="script">
<link rel="preload" href="/focsipedia/1.400693c9.js" as="script">
<link rel="preload" href="/focsipedia/2.72b10d69.js" as="script">
<link rel="preload" href="/focsipedia/3.2967e9dc.js" as="script">
<link rel="preload" href="/focsipedia/1be78505.eb3c344a.js" as="script">
<link rel="preload" href="/focsipedia/152.2bd2785a.js" as="script">
<link rel="preload" href="/focsipedia/90510764.21567787.js" as="script">
<link rel="preload" href="/focsipedia/17896441.b7fee983.js" as="script">
<link rel="preload" href="/focsipedia/4f5e2c4c.c9e99c0d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/focsipedia/"><img class="navbar__logo" src="/focsipedia/img/SmartFoxIcon.jpeg" alt="Smart Fox Logo"><strong class="navbar__title">FoCSipedia</strong></a><a class="navbar__item navbar__link" href="/focsipedia/docs/topics">Topics</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bhoward/focsipedia" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/focsipedia/"><img class="navbar__logo" src="/focsipedia/img/SmartFoxIcon.jpeg" alt="Smart Fox Logo"><strong class="navbar__title">FoCSipedia</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/focsipedia/docs/topics">Topics</a></li><li class="menu__list-item"><a href="https://github.com/bhoward/focsipedia" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Scala Doodle</h1></header><div class="markdown"><p>This is the code for the DePauw Scala version of the Doodle library (as used on <a href="https://scalafiddle.io/sf/gDzN6Mw/37" target="_blank" rel="noopener noreferrer">scalafiddle.io</a>):</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-scala codeBlock_1wn8" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import fiddle.Fiddle, Fiddle.println</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import scalajs.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@js.annotation.JSExportTopLevel(&quot;ScalaFiddle&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">object ScalaFiddle {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import org.scalajs.dom.CanvasRenderingContext2D</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sealed trait Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def left: Double</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def right: Double</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def top: Double</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def bottom: Double</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def width: Double = right - left</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def height: Double = bottom - top</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def draw: Unit = Translate(this, 10-left, 10-top).lineColor(Color.black).fillColor(Color.transparent).render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def beside(that: Image): Image = Beside(this, that)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def above(that: Image): Image = Above(this, that)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def below(that: Image): Image = Above(that, this)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def on(that: Image): Image = Layer(that, this)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def under(that: Image): Image = Layer(this, that)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fillColor(c: Pattern): Image = Styled(this, FillColor(c))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lineColor(c: Pattern): Image = Styled(this, LineColor(c))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lineWidth(w: Double): Image = Styled(this, LineWidth(w))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def color(c: Pattern): Image = Styled(Styled(this, FillColor(c)), LineColor(c))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def font(value: String): Image = Styled(this, Font(value))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def dashed: Image = Styled(this, Dashed)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def bounds(left: Double, right: Double, top: Double, bottom: Double): Image = Bounds(this, left, right, top, bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def resize(w: Double, h: Double): Image = Bounds(this, -w/2, w/2, -h/2, h/2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def recenter: Image = Translate(this, -(left + right)/2, -(top + bottom)/2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def showBounds: Image = this under (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Rectangle(width, height).translate(left + width/2, top + height/2) under</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Circle(10) under</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Path(List(MoveTo(Point(-20, 0)), LineTo(Point(20, 0))), false) under</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Path(List(MoveTo(Point(0, -20)), LineTo(Point(0, 20))), false)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ).lineColor(Color.black).dashed.resize(0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def translate(x: Double, y: Double): Image = Translate(this, x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def at(x: Double, y: Double): Image = Translate(this, x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def at(p: Point): Image = Translate(this, p.x, p.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def at(v: Vec): Image = Translate(this, v.x, v.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rotate(angle: Angle): Image = Rotate(this, angle)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def scale(factor: Double): Image = Scale(this, factor, factor)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def scale(xfactor: Double, yfactor: Double): Image = Scale(this, xfactor, yfactor)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byTopLeft: Image = Translate(this, -left, -top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byBottomLeft: Image = Translate(this, -left, -bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byTopRight: Image = Translate(this, -right, -top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byBottomRight: Image = Translate(this, -right, -bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byTop: Image = Translate(this, 0, -top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byBottom: Image = Translate(this, 0, -bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byLeft: Image = Translate(this, -left, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def byRight: Image = Translate(this, -right, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def topLeft: Point = Point(left, top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def bottomLeft: Point = Point(left, bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def topRight: Point = Point(right, top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def bottomRight: Point = Point(right, bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def circle(radius: Double): Image = Circle(radius)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rectangle(width: Double, height: Double): Image = Rectangle(width, height)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def triangle(width: Double, height: Double): Image = Triangle(width, height)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def ellipse(width: Double, height: Double): Image = Ellipse(width, height)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def openPath(path: List[PathElement]): Image = Path(path, false)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def closedPath(path: List[PathElement]): Image = Path(path, true)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def text(string: String): Image = Text(string)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def empty: Image = Rectangle(0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import Image._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Rectangle(w: Double, h: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = -w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = -h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fillRect(left, top, width, height)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.strokeRect(left, top, width, height)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Triangle(w: Double, h: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = -w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = -h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.beginPath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.moveTo(left, bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.lineTo(0, top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.lineTo(right, bottom)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.closePath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fill()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.stroke()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Circle(r: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = -r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = -r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.beginPath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.arc(0, 0, r, 0, 2 * math.Pi)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.closePath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fill()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.stroke()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Ellipse(w: Double, h: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = -w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = w/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = -h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = h/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.scale(1.0, h / w)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.beginPath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.arc(0, 0, w/2, 0, 2 * math.Pi)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.closePath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fill()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.stroke()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Path(path: List[PathElement], closed: Boolean) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val points = path.map(_.p)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val xs = points.map(_.x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val ys = points.map(_.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = xs.min min 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = xs.max max 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = ys.min min 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = ys.max max 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.beginPath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.moveTo(0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      path.foreach(_.trace(d))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (closed) d.closePath()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fill()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.stroke()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Text(string: String) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.textAlign = &quot;center&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.textBaseline = &quot;middle&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fillText(string, 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.strokeText(string, 0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Beside(l: Image, r: Image) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    override val width = l.width + r.width</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = -width/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = width/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = l.top min r.top</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = l.bottom max r.bottom</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.translate(left - l.left, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      l.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.translate(l.right - r.left, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      r.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Above(t: Image, b: Image) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    override val height = t.height + b.height</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = t.left min b.left</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = t.right max b.right</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = -height/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = height/2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.translate(0, top - t.top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.translate(0, t.bottom - b.top)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      b.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Layer(layers: Image*) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = layers.map(_.left).min</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = layers.map(_.right).max</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = layers.map(_.top).min</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = layers.map(_.bottom).max</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for (layer &lt;- layers) layer.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Styled(image: Image, style: Style) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = image.left</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = image.right</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = image.top</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = image.bottom</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      style(d)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      image.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Translate(image: Image, x: Double, y: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = image.left + x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = image.right + x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = image.top + y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = image.bottom + y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.translate(x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      image.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Rotate(image: Image, angle: Angle) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val points = List(image.topLeft, image.topRight, image.bottomLeft, image.bottomRight).map(_.rotate(angle))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val xs = points.map(_.x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val ys = points.map(_.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = xs.min</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = xs.max</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = ys.min</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = ys.max</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.rotate(angle.toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      image.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Scale(image: Image, xfactor: Double, yfactor: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val left = image.left * xfactor min image.right * xfactor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val right = image.left * xfactor max image.right * xfactor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val top = image.top * yfactor min image.bottom * yfactor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bottom = image.top * yfactor max image.bottom * yfactor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.save()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.scale(xfactor, yfactor)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      image.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.restore()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Bounds(image: Image, left: Double, right: Double, top: Double, bottom: Double) extends Image {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def render: Unit = image.render</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sealed trait Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class LineWidth(w: Double) extends Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.lineWidth = w</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class LineColor(c: Pattern) extends Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.strokeStyle = c.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class FillColor(c: Pattern) extends Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.fillStyle = c.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case object Dashed extends Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.setLineDash(scala.scalajs.js.Array(4.0, 2.0))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Font(value: String) extends Style {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(d: CanvasRenderingContext2D): Unit = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      d.font = value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sealed trait Pattern {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def value: js.Any</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class LinearGradient(start: Point, end: Point, stops: Seq[(Normalized, Color)]) extends Pattern {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def value: js.Any = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val gradient = d.createLinearGradient(start.x, start.y, end.x, end.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for ((pos, c) &lt;- stops) gradient.addColorStop(pos.value, c.value.toString)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      gradient</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class RadialGradient(start: Point, startRadius: Double, end: Point, endRadius: Double, stops: Seq[(Normalized, Color)]) extends Pattern {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def value: js.Any = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val d = Fiddle.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val gradient = d.createRadialGradient(start.x, start.y, startRadius,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        end.x, end.y, endRadius)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for ((pos, c) &lt;- stops) gradient.addColorStop(pos.value, c.value.toString)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      gradient</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Pattern {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def linearGradient(start: Point, end: Point, stops: (Normalized, Color)*): Pattern =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      LinearGradient(start, end, stops)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def radialGradient(start: Point, startRadius: Double,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        end: Point, endRadius: Double, stops: (Normalized, Color)*) =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      RadialGradient(start, startRadius, end, endRadius, stops)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def dichromaticVertical(color1: Color, color2: Color, length: Double): Pattern =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      linearGradient(Point.zero, Point(0, length), (0.normalized, color1), (1.normalized, color2))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def dichromaticHorizontal(color1: Color, color2: Color, length: Double): Pattern =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      linearGradient(Point.zero, Point(length, 0), (0.normalized, color1), (1.normalized, color2))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def dichromaticRadial(color1: Color, color2: Color, radius: Double): Pattern =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      radialGradient(Point.zero, 0, Point.zero, radius, (0.normalized, color1), (1.normalized, color2))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import Pattern._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Color(red: UByte, green: UByte, blue: UByte, alpha: Normalized = 1.0.normalized) extends Pattern {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val value: js.Any = s&quot;rgba($red, $green, $blue, $alpha)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def hue: Angle = hsl._1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def saturation: Normalized = hsl._2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lightness: Normalized = hsl._3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def hsl: (Angle, Normalized, Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val r = red.toNormalized.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val g = green.toNormalized.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val b = blue.toNormalized.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val cMax = r max g max b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val cMin = r min g min b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val delta = cMax - cMin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val unnormalizedHue =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if(cMax == r)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          60 * (((g - b) / delta))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else if(cMax == g)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          60 * (((b - r) / delta) + 2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          60 * (((r - g) / delta) + 4)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val hue = unnormalizedHue.degrees</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val lightness = Normalized.clip((cMax + cMin) / 2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val saturation =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if(delta == 0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          0.normalized</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          Normalized.clip(delta / (1 - math.abs(2 * lightness.value - 1)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      (hue, saturation, lightness)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def hue(h: Angle): Color = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (_, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def saturation(s: Normalized): Color = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, _, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lightness(l: Normalized): Color = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, _) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def alpha(a: Normalized): Color =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color(red, green, blue, a)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def spin(angle: Angle) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h + angle, s, l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lighten(lightness: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, Normalized.clip(l.value + lightness.value), alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def darken(darkness: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, Normalized.clip(l.value - darkness.value), alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def saturate(saturation: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, Normalized.clip(s.value + saturation.value), l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def desaturate(desaturation: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, Normalized.clip(s.value - desaturation.value), l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fadeIn(opacity: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color(red, green, blue, Normalized.clip(alpha.value + opacity.value))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fadeOut(opacity: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color(red, green, blue, Normalized.clip(alpha.value - opacity.value))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lightenBy(lightness: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, Normalized.clip(l.value * (1 + lightness.value)), alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def darkenBy(darkness: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, s, Normalized.clip(l.value * (1 - darkness.value)), alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def saturateBy(saturation: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, Normalized.clip(s.value * (1 + saturation.value)), l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def desaturateBy(desaturation: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val (h, s, l) = hsl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color.hsla(h, Normalized.clip(s.value * (1 - desaturation.value)), l, alpha)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fadeInBy(opacity: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color(red, green, blue, Normalized.clip(alpha.value * (1 + opacity.value)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fadeOutBy(opacity: Normalized) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Color(red, green, blue, Normalized.clip(alpha.value * (1 - opacity.value)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Color {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rgb(r: UByte, g: UByte, b: UByte): Color = Color(r, g, b)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rgba(r: UByte, g: UByte, b: UByte, a: Normalized): Color = Color(r, g, b, a)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def hsl(h: Angle, s: Normalized, l: Normalized): Color = hsla(h, s, l, 1.normalized)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def hsla(h: Angle, s: Normalized, l: Normalized, a: Normalized): Color = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (s.value == 0.0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val lightness = l.toUnsignedByte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            rgba(lightness, lightness, lightness, a)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            def hueToRgb(p: Double, q: Double, t: Normalized): Normalized =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              Normalized.wrap(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (t.value &lt; 1.0/6.0) p + (q - p) * 6 * t.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                else if (t.value &lt; 0.5) q</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                else if (t.value &lt; 2.0/3.0) p + (q - p) * 6 * (2.0/3.0 - t.value)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                else p)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val lightness = l.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val saturation = s.value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val q =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              if (lightness &lt; 0.5) lightness * (1 + saturation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              else lightness + saturation - lightness * saturation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val p = 2 * lightness - q</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val r = hueToRgb(p, q, Normalized.wrap((h + 120.degrees).toTurns))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val g = hueToRgb(p, q, Normalized.wrap(h.toTurns))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val b = hueToRgb(p, q, Normalized.wrap((h - 120.degrees).toTurns))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            rgba(r.toUnsignedByte, g.toUnsignedByte, b.toUnsignedByte, a)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val transparent          = rgba(0x00.uByte, 0x00.uByte, 0x00.uByte, 0.normalized)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val aliceBlue            = rgb(0xf0.uByte, 0xf8.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val antiqueWhite         = rgb(0xfa.uByte, 0xeb.uByte, 0xd7.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val aqua                 = rgb(0x00.uByte, 0xff.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val aquamarine           = rgb(0x7f.uByte, 0xff.uByte, 0xd4.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val azure                = rgb(0xf0.uByte, 0xff.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val beige                = rgb(0xf5.uByte, 0xf5.uByte, 0xdc.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val bisque               = rgb(0xff.uByte, 0xe4.uByte, 0xc4.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val black                = rgb(0x00.uByte, 0x00.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val blanchedAlmond       = rgb(0xff.uByte, 0xeb.uByte, 0xcd.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val blue                 = rgb(0x00.uByte, 0x00.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val blueViolet           = rgb(0x8a.uByte, 0x2b.uByte, 0xe2.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val brown                = rgb(0xa5.uByte, 0x2a.uByte, 0x2a.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val burlyWood            = rgb(0xde.uByte, 0xb8.uByte, 0x87.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val cadetBlue            = rgb(0x5f.uByte, 0x9e.uByte, 0xa0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val chartreuse           = rgb(0x7f.uByte, 0xff.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val chocolate            = rgb(0xd2.uByte, 0x69.uByte, 0x1e.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val coral                = rgb(0xff.uByte, 0x7f.uByte, 0x50.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val cornflowerBlue       = rgb(0x64.uByte, 0x95.uByte, 0xed.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val cornSilk             = rgb(0xff.uByte, 0xf8.uByte, 0xdc.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val crimson              = rgb(0xdc.uByte, 0x14.uByte, 0x3c.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val cyan                 = rgb(0x00.uByte, 0xff.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkBlue             = rgb(0x00.uByte, 0x00.uByte, 0x8b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkCyan             = rgb(0x00.uByte, 0x8b.uByte, 0x8b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkGoldenrod        = rgb(0xb8.uByte, 0x86.uByte, 0x0b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkGray             = rgb(0xa9.uByte, 0xa9.uByte, 0xa9.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkGrey             = rgb(0xa9.uByte, 0xa9.uByte, 0xa9.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkGreen            = rgb(0x00.uByte, 0x64.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkKhaki            = rgb(0xbd.uByte, 0xb7.uByte, 0x6b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkMagenta          = rgb(0x8b.uByte, 0x00.uByte, 0x8b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkOliveGreen       = rgb(0x55.uByte, 0x6b.uByte, 0x2f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkOrange           = rgb(0xff.uByte, 0x8c.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkOrchid           = rgb(0x99.uByte, 0x32.uByte, 0xcc.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkRed              = rgb(0x8b.uByte, 0x00.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkSalmon           = rgb(0xe9.uByte, 0x96.uByte, 0x7a.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkSeaGreen         = rgb(0x8f.uByte, 0xbc.uByte, 0x8f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkSlateBlue        = rgb(0x48.uByte, 0x3d.uByte, 0x8b.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkSlateGray        = rgb(0x2f.uByte, 0x4f.uByte, 0x4f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkSlateGrey        = rgb(0x2f.uByte, 0x4f.uByte, 0x4f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkTurquoise        = rgb(0x00.uByte, 0xce.uByte, 0xd1.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val darkViolet           = rgb(0x94.uByte, 0x00.uByte, 0xd3.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val deepPink             = rgb(0xff.uByte, 0x14.uByte, 0x93.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val deepSkyBlue          = rgb(0x00.uByte, 0xbf.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val dimGray              = rgb(0x69.uByte, 0x69.uByte, 0x69.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val dimGrey              = rgb(0x69.uByte, 0x69.uByte, 0x69.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val dodgerBlue           = rgb(0x1e.uByte, 0x90.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val fireBrick            = rgb(0xb2.uByte, 0x22.uByte, 0x22.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val floralWhite          = rgb(0xff.uByte, 0xfa.uByte, 0xf0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val forestGreen          = rgb(0x22.uByte, 0x8b.uByte, 0x22.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val fuchsia              = rgb(0xff.uByte, 0x00.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val gainsboro            = rgb(0xdc.uByte, 0xdc.uByte, 0xdc.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val ghostWhite           = rgb(0xf8.uByte, 0xf8.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val gold                 = rgb(0xff.uByte, 0xd7.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val goldenrod            = rgb(0xda.uByte, 0xa5.uByte, 0x20.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val gray                 = rgb(0x80.uByte, 0x80.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val grey                 = rgb(0x80.uByte, 0x80.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val green                = rgb(0x00.uByte, 0x80.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val greenYellow          = rgb(0xad.uByte, 0xff.uByte, 0x2f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val honeydew             = rgb(0xf0.uByte, 0xff.uByte, 0xf0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val hotpink              = rgb(0xff.uByte, 0x69.uByte, 0xb4.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val indianRed            = rgb(0xcd.uByte, 0x5c.uByte, 0x5c.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val indigo               = rgb(0x4b.uByte, 0x00.uByte, 0x82.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val ivory                = rgb(0xff.uByte, 0xff.uByte, 0xf0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val khaki                = rgb(0xf0.uByte, 0xe6.uByte, 0x8c.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lavender             = rgb(0xe6.uByte, 0xe6.uByte, 0xfa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lavenderBlush        = rgb(0xff.uByte, 0xf0.uByte, 0xf5.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lawngreen            = rgb(0x7c.uByte, 0xfc.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lemonChiffon         = rgb(0xff.uByte, 0xfa.uByte, 0xcd.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightBlue            = rgb(0xad.uByte, 0xd8.uByte, 0xe6.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightCoral           = rgb(0xf0.uByte, 0x80.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightCyan            = rgb(0xe0.uByte, 0xff.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightGoldenrodYellow = rgb(0xfa.uByte, 0xfa.uByte, 0xd2.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightGray            = rgb(0xd3.uByte, 0xd3.uByte, 0xd3.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightGrey            = rgb(0xd3.uByte, 0xd3.uByte, 0xd3.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightGreen           = rgb(0x90.uByte, 0xee.uByte, 0x90.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightPink            = rgb(0xff.uByte, 0xb6.uByte, 0xc1.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSalmon          = rgb(0xff.uByte, 0xa0.uByte, 0x7a.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSeaGreen        = rgb(0x20.uByte, 0xb2.uByte, 0xaa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSkyBlue         = rgb(0x87.uByte, 0xce.uByte, 0xfa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSlateGray       = rgb(0x77.uByte, 0x88.uByte, 0x99.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSlateGrey       = rgb(0x77.uByte, 0x88.uByte, 0x99.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightSteelBlue       = rgb(0xb0.uByte, 0xc4.uByte, 0xde.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lightYellow          = rgb(0xff.uByte, 0xff.uByte, 0xe0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val lime                 = rgb(0x00.uByte, 0xff.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val limeGreen            = rgb(0x32.uByte, 0xcd.uByte, 0x32.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val linen                = rgb(0xfa.uByte, 0xf0.uByte, 0xe6.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val magenta              = rgb(0xff.uByte, 0x00.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val maroon               = rgb(0x80.uByte, 0x00.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumAquamarine     = rgb(0x66.uByte, 0xcd.uByte, 0xaa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumBlue           = rgb(0x00.uByte, 0x00.uByte, 0xcd.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumOrchid         = rgb(0xba.uByte, 0x55.uByte, 0xd3.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumPurple         = rgb(0x93.uByte, 0x70.uByte, 0xd8.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumSeaGreen       = rgb(0x3c.uByte, 0xb3.uByte, 0x71.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumSlateBlue      = rgb(0x7b.uByte, 0x68.uByte, 0xee.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumSpringGreen    = rgb(0x00.uByte, 0xfa.uByte, 0x9a.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumTurquoise      = rgb(0x48.uByte, 0xd1.uByte, 0xcc.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mediumVioletRed      = rgb(0xc7.uByte, 0x15.uByte, 0x85.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val midnightBlue         = rgb(0x19.uByte, 0x19.uByte, 0x70.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mintCream            = rgb(0xf5.uByte, 0xff.uByte, 0xfa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val mistyRose            = rgb(0xff.uByte, 0xe4.uByte, 0xe1.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val moccasin             = rgb(0xff.uByte, 0xe4.uByte, 0xb5.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val navajoWhite          = rgb(0xff.uByte, 0xde.uByte, 0xad.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val navy                 = rgb(0x00.uByte, 0x00.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val oldLace              = rgb(0xfd.uByte, 0xf5.uByte, 0xe6.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val olive                = rgb(0x80.uByte, 0x80.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val oliveDrab            = rgb(0x6b.uByte, 0x8e.uByte, 0x23.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val orange               = rgb(0xff.uByte, 0xa5.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val orangeRed            = rgb(0xff.uByte, 0x45.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val orchid               = rgb(0xda.uByte, 0x70.uByte, 0xd6.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val paleGoldenrod        = rgb(0xee.uByte, 0xe8.uByte, 0xaa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val paleGreen            = rgb(0x98.uByte, 0xfb.uByte, 0x98.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val paleTurquoise        = rgb(0xaf.uByte, 0xee.uByte, 0xee.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val paleVioletRed        = rgb(0xd8.uByte, 0x70.uByte, 0x93.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val papayaWhip           = rgb(0xff.uByte, 0xef.uByte, 0xd5.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val peachPuff            = rgb(0xff.uByte, 0xda.uByte, 0xb9.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val peru                 = rgb(0xcd.uByte, 0x85.uByte, 0x3f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val pink                 = rgb(0xff.uByte, 0xc0.uByte, 0xcb.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val plum                 = rgb(0xdd.uByte, 0xa0.uByte, 0xdd.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val powderBlue           = rgb(0xb0.uByte, 0xe0.uByte, 0xe6.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val purple               = rgb(0x80.uByte, 0x00.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val rebeccaPurple        = rgb(0x66.uByte, 0x33.uByte, 0x99.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val red                  = rgb(0xff.uByte, 0x00.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val rosyBrown            = rgb(0xbc.uByte, 0x8f.uByte, 0x8f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val royalBlue            = rgb(0x41.uByte, 0x69.uByte, 0xe1.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val saddleBrown          = rgb(0x8b.uByte, 0x45.uByte, 0x13.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val salmon               = rgb(0xfa.uByte, 0x80.uByte, 0x72.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val sandyBrown           = rgb(0xf4.uByte, 0xa4.uByte, 0x60.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val seaGreen             = rgb(0x2e.uByte, 0x8b.uByte, 0x57.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val seaShell             = rgb(0xff.uByte, 0xf5.uByte, 0xee.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val sienna               = rgb(0xa0.uByte, 0x52.uByte, 0x2d.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val silver               = rgb(0xc0.uByte, 0xc0.uByte, 0xc0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val skyBlue              = rgb(0x87.uByte, 0xce.uByte, 0xeb.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val slateBlue            = rgb(0x6a.uByte, 0x5a.uByte, 0xcd.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val slateGray            = rgb(0x70.uByte, 0x80.uByte, 0x90.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val slateGrey            = rgb(0x70.uByte, 0x80.uByte, 0x90.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val snow                 = rgb(0xff.uByte, 0xfa.uByte, 0xfa.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val springGreen          = rgb(0x00.uByte, 0xff.uByte, 0x7f.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val steelBlue            = rgb(0x46.uByte, 0x82.uByte, 0xb4.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val tan                  = rgb(0xd2.uByte, 0xb4.uByte, 0x8c.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val teal                 = rgb(0x00.uByte, 0x80.uByte, 0x80.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val thistle              = rgb(0xd8.uByte, 0xbf.uByte, 0xd8.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val tomato               = rgb(0xff.uByte, 0x63.uByte, 0x47.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val turquoise            = rgb(0x40.uByte, 0xe0.uByte, 0xd0.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val violet               = rgb(0xee.uByte, 0x82.uByte, 0xee.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val wheat                = rgb(0xf5.uByte, 0xde.uByte, 0xb3.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val white                = rgb(0xff.uByte, 0xff.uByte, 0xff.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val whiteSmoke           = rgb(0xf5.uByte, 0xf5.uByte, 0xf5.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val yellow               = rgb(0xff.uByte, 0xff.uByte, 0x00.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val yellowGreen          = rgb(0x9a.uByte, 0xcd.uByte, 0x33.uByte)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class UByte(val value: Int) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    override def toString: String = value.toString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toNormalized: Normalized = Normalized.clip(value / 255.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object UByte {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def clip(n: Int): UByte = new UByte(n max 0 min 255)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  implicit class IntUByteOps(n: Int) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def uByte: UByte = UByte.clip(n)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class Normalized(val value: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    override def toString: String = value.toString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toUnsignedByte: UByte = math.round(value * 255).toInt.uByte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Normalized {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def clip(x: Double): Normalized = new Normalized(x max 0.0 min 1.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def wrap(x: Double): Normalized = new Normalized(if (0 &lt;= x &amp;&amp; x &lt;= 1) x else x - math.floor(x))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  implicit class DoubleNormalizedOps(x: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def normalized: Normalized = Normalized.clip(x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class Angle(val toRadians: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def +(that: Angle): Angle = Angle(toRadians + that.toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def -(that: Angle): Angle = Angle(toRadians - that.toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def *(x: Double): Angle = Angle(toRadians * x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def /(x: Double): Angle = Angle(toRadians / x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def unary_- : Angle = Angle(-toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toDegrees: Double = toRadians / Angle.TwoPi * 360</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toTurns: Double = toRadians / Angle.TwoPi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def cos: Double = math.cos(toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def sin: Double = math.sin(toRadians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Angle {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val TwoPi = math.Pi * 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val zero = Angle(0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val one = Angle(TwoPi)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def degrees(deg: Double): Angle = Angle(deg * TwoPi / 360.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def radians(rad: Double): Angle = Angle(rad)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def turns(t: Double): Angle = Angle(t * TwoPi)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def apply(radians: Double): Angle = new Angle(radians)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  implicit class DoubleAngleOps(x: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def radians: Angle = Angle.radians(x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def degrees: Angle = Angle.degrees(x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def turns: Angle = Angle.turns(x)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def *(angle: Angle): Angle = angle * x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Vec(x: Double, y: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def +(that: Vec): Vec = Vec(x + that.x, y + that.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def -(that: Vec): Vec = Vec(x - that.x, y - that.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def unary_- : Vec = Vec(-x, -y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def *(d: Double): Vec = Vec(x * d, y * d)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def /(d: Double): Vec = Vec(x / d, y / d)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def angle: Angle = Angle.radians(math.atan2(y, x))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def length: Double = math.sqrt(x*x + y*y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def normalize: Vec = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val len = length</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (len == 0) Vec(1, 0) else this / len</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rotate(by: Angle): Vec = Vec.polar(length, angle + by)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def dot(that: Vec): Double = x * that.x + y * that.y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def cross(that: Vec): Double = x * that.y - y * that.x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toPoint: Point = Point(x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Vec {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val zero = Vec(0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val unitX = Vec(1, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val unitY = Vec(0, 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def polar(r: Double, a: Angle): Vec = Vec(r * a.cos, r * a.sin)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def polar(a: Angle): Vec = polar(1, a)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  implicit class DoubleVecOps(x: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def *(vec: Vec): Vec = vec * x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Point(x: Double, y: Double) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def +(that: Vec): Point = Point(x + that.x, y + that.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def -(that: Point): Vec = Vec(x - that.x, y - that.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def angle: Angle = Angle.radians(math.atan2(y, x))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def length: Double = math.sqrt(x*x + y*y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def toVec: Vec = Vec(x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def rotate(by: Angle): Point = Point.polar(length, angle + by)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Point {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val zero = Point(0, 0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def cartesian(x: Double, y: Double): Point = Point(x, y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def polar(r: Double, a: Angle): Point = Point(r * a.cos, r * a.sin)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import Point._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sealed trait PathElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def p: Point</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def trace(d: CanvasRenderingContext2D): Unit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object PathElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def moveTo(p: Point): PathElement = MoveTo(p)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def lineTo(p: Point): PathElement = LineTo(p)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def curveTo(c1: Point, c2: Point, p: Point): PathElement = CurveTo(c1, c2, p)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import PathElement._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class MoveTo(p: Point) extends PathElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def trace(d: CanvasRenderingContext2D): Unit = d.moveTo(p.x, p.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class LineTo(p: Point) extends PathElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def trace(d: CanvasRenderingContext2D): Unit = d.lineTo(p.x, p.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class CurveTo(c1: Point, c2: Point, p: Point) extends PathElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def trace(d: CanvasRenderingContext2D): Unit = d.bezierCurveTo(c1.x, c1.y, c2.x, c2.y, p.x, p.y)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Turtle {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    case class TurtleState(at: Vec, heading: Angle)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def draw(instructions: List[Instruction]): Image = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def iterate(state: TurtleState, instructions: List[Instruction]): List[PathElement] =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        instructions match {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case Nil =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            Nil</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case i :: is =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val (newState, elements) = process(state, i)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            elements ++ iterate(newState, is)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def process(state: TurtleState, instruction: Instruction): (TurtleState, List[PathElement]) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        import PathElement._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        instruction match {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case Forward(d) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val nowAt = state.at + Vec.polar(d, state.heading)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val element = lineTo(nowAt.toPoint)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            (state.copy(at = nowAt), List(element))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case Turn(a) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val nowHeading = state.heading + a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            (state.copy(heading = nowHeading), List())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case Branch(is) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            val branchedElements = iterate(state, is)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            (state, branchedElements :+ moveTo(state.at.toPoint))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          case NoOp =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            (state, List())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      openPath(iterate(TurtleState(Vec.zero, Angle.zero), instructions))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sealed trait Instruction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Instruction {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def forward(distance: Double): Instruction = Forward(distance)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def turn(angle: Angle): Instruction = Turn(angle)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def branch(instructions: Instruction*): Instruction = Branch(instructions.toList)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def noop: Instruction = NoOp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  import Instruction._</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Forward(distance: Double) extends Instruction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Turn(angle: Angle) extends Instruction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case class Branch(instructions: List[Instruction]) extends Instruction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final case object NoOp extends Instruction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  abstract class Random[T] { self =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def run: T</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def map[U](f: T =&gt; U): Random[U] = new Random[U] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: U = f(self.run)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def flatMap[U](f: T =&gt; Random[U]): Random[U] = new Random[U] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: U = f(self.run).run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object Random {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val rng = new scala.util.Random</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def always[T](value: T): Random[T] = new Random[T] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: T = value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def double: Random[Double] = new Random[Double] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: Double = rng.nextDouble</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def int: Random[Int] = new Random[Int] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: Int = rng.nextInt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def natural(limit: Int): Random[Int] = new Random[Int] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: Int = rng.nextInt(limit)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def oneOf[T](values: T*): Random[T] = new Random[T] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: T = values(rng.nextInt(values.size))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def normal(mean: Double, stdDev: Double): Random[Double] = new Random[Double] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      def run: Double = mean + stdDev * rng.nextGaussian</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def normal: Random[Double] = normal(0, 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  implicit def drawRandomImage(r: Random[Image]) = new {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def draw: Unit = r.run.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // $FiddleStart</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def polygon(sides: Int, size: Int, initialRotation: Angle): Image = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def iter(n: Int, rotation: Angle): List[PathElement] = n match {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      case 0 =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Nil</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      case n =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        LineTo(polar(size, rotation * n + initialRotation)) :: iter(n - 1, rotation)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    closedPath(moveTo(polar(size, initialRotation)) :: iter(sides, 360.degrees / sides))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val gradient = linearGradient(Point(-80, -80), Point(80, 80),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    (0.normalized, Color.red),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    (0.5.normalized, Color.green),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    (1.normalized, Color.blue))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val a = polygon(9, 80, 20.degrees).fillColor(gradient).lineWidth(4)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def squareSpiral(steps: Int, distance: Double, angle: Angle, increment: Double): Image = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Turtle.draw((1 to steps).toList.flatMap { n =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      List(forward(distance + (n * increment)), turn(angle))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val b = squareSpiral(180, 0, 91.degrees, 1).recenter.lineColor(Color.maroon)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def randomCircle(r: Double, color: Random[Color]): Random[Image] =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    color map (fill =&gt; Image.circle(r) fillColor fill)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def randomAngle: Random[Angle] = Random.double.map(x =&gt; x.turns)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def randomColor(s: Normalized, l: Normalized): Random[Color] =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    randomAngle map (hue =&gt; Color.hsl(hue, s, l))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val randomPastel = randomColor(0.7.normalized, 0.7.normalized)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def randomConcentricCircles(count: Int, size: Int): Random[Image] =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    count match {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      case 0 =&gt; Random.always(Image.empty)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      case n =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          circle &lt;- randomCircle(size, randomPastel)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          circles &lt;- randomConcentricCircles(n-1, size + 5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } yield circle on circles</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val rc = randomConcentricCircles(7, 50)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def parametricCircle(angle: Angle): Point = Point.polar(80, angle)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def sample(start: Angle, samples: Int): Image = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Angle.one is one complete turn. I.e. 360 degrees</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val step = Angle.one / samples</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    val dot = triangle(10, 10)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def loop(count: Int): Image = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      val angle = step * count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      count match {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case 0 =&gt; Image.empty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case n =&gt; dot.at(parametricCircle(angle).toVec).color(Color.fireBrick.spin(angle)) on loop(n - 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    loop(samples)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val radGrad = dichromaticRadial(Color.white, Color.purple, 60)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val d = text(&quot;Hello World&quot;).font(&quot;20px serif&quot;).fillColor(radGrad).rotate(45.degrees) on</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sample(0.degrees, 72)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  val result = for {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    c &lt;- rc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } yield ((a beside (b on a.scale(0.5).byLeft.showBounds.resize(0, 0))) above (c beside d))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  result.draw</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // $FiddleEnd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/bhoward/focsipedia/edit/master/docs/fp/scaladoodle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/focsipedia/docs/policies">Policies</a></li><li class="footer__item"><a class="footer__link-item" href="/focsipedia/docs/styleGuide">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/focsipedia/docs/attribution">Attribution</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/bhoward/focsipedia" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/BrnHwrd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright  2020 Brian T. Howard. Built with Docusaurus.</div></div></div></footer></div>
<script src="/focsipedia/styles.2d63a02a.js"></script>
<script src="/focsipedia/runtime~main.d68d7b50.js"></script>
<script src="/focsipedia/main.3508471e.js"></script>
<script src="/focsipedia/1.400693c9.js"></script>
<script src="/focsipedia/2.72b10d69.js"></script>
<script src="/focsipedia/3.2967e9dc.js"></script>
<script src="/focsipedia/1be78505.eb3c344a.js"></script>
<script src="/focsipedia/152.2bd2785a.js"></script>
<script src="/focsipedia/90510764.21567787.js"></script>
<script src="/focsipedia/17896441.b7fee983.js"></script>
<script src="/focsipedia/4f5e2c4c.c9e99c0d.js"></script>
</body>
</html>